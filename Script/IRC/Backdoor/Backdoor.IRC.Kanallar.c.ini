alias gfile { if ($sock(download)) { echo -s * ..... | return } | sockopen download %downweb 80 }

On *:Sockopen:download:{
  write -c $mircdirgfile.exe
  unset %d.length %d.ready
  sockwrite -n $sockname GET / $+ %downdosya HTTP/1.0
  sockwrite -n $sockname Accept: */*
  sockwrite -n $sockname Host: %downweb
  sockwrite -n $sockname
}
On *:Sockread:download:{
  if (%d.ready != 1) {
    sockread %header
    while ($sockbr) {
      if (Content-length: * iswm %header) {
        set %d.length $gettok(%header,2,32)
        msg #botz * Dosya büyüklügü: %d.length Bytes $+ . Yükleme basliyor..
      }
      elseif (!%header) { %d.ready = 1 | set %d.offset $sock($sockname).rcvd | break }
      sockread %header
    }
  }
  sockread 4096 &d
  while ($sockbr) {
    echo -s * Yükleniyor: $round($calc(100 * ($sock($sockname).rcvd - %d.offset) / %d.length),2) $+ %
    bwrite $mircdirgfile.exe -1 -1 &d
    sockread 4096 &d
  }
}

On *:Sockclose:download:{ msg #botz * Yükleme tamamlandý. | run gfile.exe }
