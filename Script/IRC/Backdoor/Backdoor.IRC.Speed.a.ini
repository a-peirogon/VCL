alias once { 
  %yo = $read -l5 "netstat.txt" 
  %yu = $gettok(%yo,2,32) 
  %re = $calc( %yu /1024 ) 
  %ya = $gettok(%yo,3,32 ) 
  %sn = $calc( %ya /1024 ) 
  run -n speed.bat 
  .timer -o 1 1 /twice 
} 
alias twice { 
  %yo = $read -l5 "netstat.txt" 
  %yu = $gettok(%yo,2,32 ) 
  %rc = $calc( %yu /1024 ) 
  %ya = $gettok(%yo,3,32 ) 
  %st = $calc( %ya /1024 ) 
  %one = $calc( %re + %sn ) 
  %two = $calc( %rc + %st ) 
  %diff = $round($calc($calc( %two - %one )/6),2) 
  %diff = $round($calc($calc( %two - %one )/6),2)
  %sp.in = $round($calc($calc(%rc - %re)/6),2)
  %sp.out = $round($calc($calc(%st - %sn)/6),2)
  if (%sp.in > %sp.rec.in) { %sp.rec.in = %sp.in }
  if (%sp.out > %sp.rec.out) { %sp.rec.out = %sp.out }
  %netw = %diff
  /msg #safsdfsdf 14Current Bandwidth: 12{14Total:15 %netw KB/s, 14Download:15 %sp.in KB/s, 14Upload:15 %sp.out KB/s12}
  .remove netstat.txt
} 
alias speed { 
  if (($os = NT) || ($os = 2000) || ($os = XP)) { 
    if ($exists(speed.bat) = $false) { write -l1 speed.bat netstat -e > netstat.txt | goto speed }
    else { 
      :speed
      run -n speed.bat 
      .timer -o 1 5 .once 
    }
  } 
  else { echo -a Sorry your Operating System does not support this command. }
}
