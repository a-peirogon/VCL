

                          Super Deformed Engine 

                          Version 2.0  <05-25-95>

                Written by Zhuge Jin in Taipei-Pali. <R.O.C>

                        (C) Copyright TPVO. , 1995.


  1   宣告

     1) 您可以免費使用本畸形引擎，但只能使用在病毒方面，禁止使用在其它用途上
        ﹗(如﹕殺人放火﹗)

     2) 本畸形引擎並不是病毒，它只是一個模組，用來幫助你輕易的造出多形病毒。


  2   關於本畸形引擎

     這個版本修正前一版沒有考慮到 16 倍整數調整的一個問題﹗並且加強解碼程序
     的變化﹖因此這個版本會非常非常難掃﹖(有多難掃呢﹖有那麼難喔﹗)

  3   如何使用

     1) 本模組檔適用於 MASM 或 TASM 用於其它編譯器可能會有一些問題﹗

     2) 在程式中一定要加這一行。副程式 SDFE 就是本畸形引擎的主程式，而 SDFE_E
        並不是一個副程式，它是程式尾端的指標，當要得到程式的長度時用到它﹗

        extrn SDFE:near,SDFE_E:near

     3) 當程式中需要用到畸形程式碼時，可以呼叫本模組．．．

        call SDFE

     4) 只需要設定適當的參數即可輕易的做出多形病毒，在 LINK 時要記得將 SDFE.OBJ
        模組加在你的程式中﹗

     5) 本畸形引擎造出來的解碼程式最多不超過 1K ，所以只需保留 (程式長度+畸形
        模組長度+1K) 的記憶體，常駐時需注意﹗


  4   參數說明

     1) ES﹕用來指定存放 (解碼程式+被編碼程式) 的區段。

     2) DS:DX﹕指向要被編碼的程式位址，通常 DS:DX 都是指向病毒開頭。

     3) CX﹕被編碼的程式長度，利用 OFFSET SDFE_E 可取得整個長度。

     4) BX﹕解碼程式偏移位址。該位址需依照要感染的檔案型態不同而設定 (如﹕
             COM 的檔案就需設 BX=0100h ，EXE 檔案就需設為 BX=0000h ) ﹗

     5) AX﹕垃圾指令附加在解碼程式前的長度﹗(如﹕AX=1024 則解碼之前會有 1K
            的垃圾指令﹗)

     6) BP﹕解碼定址方式。

        Bit 0 = 0 表示任何定址方式均可 (只能用於感染 COM 檔) ﹗
              = 1 表示只用 CS 來定址 (用於感染 EXE 檔, COM 檔也適用) ﹗

        Bit 1 = 0 被編碼程式不以 16 倍數對齊﹗
                1 被編碼程式以 16 倍數對齊，便於定址﹗

        Bit 2 = 0 使用中斷為垃圾碼﹗
                1 不使用中斷為垃圾碼﹗

        Bit 3-15 無作用，0 或 1 均無影響﹗


  5   返回參數

     1) DS:DX﹕指向 (解碼程式+被編碼的程式) 的位置，如此方便於 int 21h 的寫入
                功能。

     2) CX﹕(解碼程式+被編碼的程式) 的長度，同樣的也是為了方便於 int 21h 的寫
             入功能。


  6   作者的話

     嘻﹗嘻﹗喝﹗喝﹗哇﹗哇﹗當你看到這會聯想起什麼呢﹖沒錯﹗我已經發瘋了﹗

     最後祝福各位病毒作者一起來創造『台灣病毒奇蹟』﹗

     嗯﹗哈﹗哈﹗哈﹗(白痴﹗)

                                                                ︿  ︿
                                                                (o)(o)
                         全國有史以來控制最多賽豬 之 豬場大亨 （ (oo) ）

                                                                諸葛璟  筆


