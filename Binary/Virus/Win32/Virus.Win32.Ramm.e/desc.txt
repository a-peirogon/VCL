   comment $
                            ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ
                            ÛÛß     ßÛß     ßÛß     ßÛÛ
                            ÛÛ   Û   Û   Û   Û   Û   ÛÛ
                            ÛÛÛßßß  ÜÛÜ      Û       ÛÛ
                            ÛÛ   ßßßßÛßßßß   Û   Û   ÛÛ
                            ÛÛ       Û      ÜÛ   Û   ÛÛ
                            ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

        ÜÜÜÜÜÜÜ ÜÜÜÜÜÜÜ ÜÜÜÜÜÜÜ ÜÜÜÜÜÜÜ ÜÜÜÜÜÜÜ       ÜÜÜÜÜÜÜ ÜÜÜÜÜ ÜÜÜ ÜÜÜ
        Û ÜÜÜ Û Û ÜÜÜ Û Û Ü Ü Û Û Ü Ü Û Û ÜÜÜÜÛ ÜÛßÛÜ Û ÜÜÜÜÛ ÛÜ ÜÛ Û ßÛÛ Û
        Û Ü ÜÜÛ Û ÜÜÜ Û Û Û Û Û Û Û Û Û ÛÜÜÜÜ Û ÛÜ ÜÛ Û ÜÜÜÛÜ ÜÛ ÛÜ Û ÛÜß Û
        ÛÜÛÜÜÜÛ ÛÜÛ ÛÜÛ ÛÜÛßÛÜÛ ÛÜÛßÛÜÛ ÛÜÜÜÜÜÛ  ßßß  ÛÜÜÜÜÜÛ ÛÜÜÜÛ ÛÜÛßÛÜÛ

                                        v4.0

                                 = Final Release =

                          (c) Lord Julus / 29A (Jul 2000)


        ===================================================================
                                   DISCLAIMER

        This is the source code of a virus. Possesing, using, spreading of
        this source code, compiling and linking it, possesing, using and
        spreading of the executable form is illegal and it is forbidden.
        Should you do such a thing, the author may not be held responsible
        for any damage that occured from the use of this source code. The
        actual purpose of this source code is for educational purposes and
        as an object of study. This source code comes as is and the author
        cannot be held responsible for the existance of other modified
        variants of this code.
        ====================================================================
        History:

        09 Sep 2000 - Today I made a small improvement. When the dropper roams
                      the net onto another computer it remains in the windows
                      dir and it represents a weak point which might be noticed
                      by an av. So, now, the virus will smartly remove either
                      the dropper or the entry in the win.ini file if one of
                      them is missing. If both are there, they are left alone
                      because they will remove eachother. Added Pstores.exe to
                      the black list. Thanks to Evul for pointing me out that
                      it is a rather peculiar file and cannot be safely
                      infected.

        22 Jul 2000 - The virus has moved up to version 4.0. Today I added
                      the network infector. It comes in a separate thread.
                      For the moment looks like everything works fine. Will
                      add a timer to it so that it does not hang in huge
                      networks... Virus is above 14k now... Waiting for the
                      LZ!

        18 Jul 2000 - Fixed a bug in the section increase algorithm: if you
                      want to have a good compatibility you NEED to place the
                      viral code exactly at the end of file and NOT at the
                      end of the VirtualSize or SizeOfRawData as it appears
                      in the section header, because many files get their
                      real size calculated at load time in some way.
                      HURRAY!!! YES!! I fixed a shitty bug! If you do section
                      add you MUST check also if any directory VA follows
                      immediately the last section header so that you will
                      not overwrite it. Now almost all files work ok under
                      NT!!!! However, I don't seem to be able to make
                      outlook.exe get infected so I put it on the black list.
                      The other MsOffice executables get infected correctly
                      on both Win9x and WinNT.

        17 Jul 2000 - Have started some optimizations and proceduralizations
                      (;-)))). The virus is quickly going towards 13k so I
                      am quite anxious to implement my new LZ routine to
                      decrease it's size. I fixed a bug: WinNT NEEDS the
                      size of headers value to be aligned to file alignment.

        14 Jul 2000 - Worked heavily on the WindowsNT compatibility. In this
                      way I was able to spot 2 bugs in the infection routine,
                      one regarding RVA of the new section and one regarding
                      the situation when the imports cannot be found by the api
                      hooker. Still thinking if I should rearrange relocs also?
                      Now files are loaded under WindowsNT (NT image is correct)
                      but they cannot fully initialize. Will research some
                      more.

        03 Jun 2000 - Added an encryption layer with no key, just a rol/ror
                      routine on parity. Also added some MMX commands. Fixed
                      a few things.

        22 May 2000 - Added EPO on files that have the viral code outside the
                      code section. Basically from now on the entry point stays
                      only into the code section. The epo is not actually epo,
                      because as I started to code it I decided to make it very
                      complicated so I will include the complicated part in the
                      next release. It will be the so called LJILE32 <Lord
                      Julus' Instruction Length Engine 32>. This engine will
                      allow me to have an exact location of the opcode for each
                      instruction so we will be able to look up any call, jump
                      or conditional jump to place our code call there. So for
                      this version only a jump at the original eip.

        21 May 2000 - Fixed a bug in the api hooker... I forgot that some import
                      sections have a null pointer to names. Also added the
                      infection by last section increase for files who cannot
                      be infected otherwise. All files should be touched now.
                      Also I fixed the problem with the payload window not
                      closing after the process closed. I solved half of it
                      as some files like wordpad.exe still have this problem.

        20 May 2000 - Prizzy helped me a lot by pointing out to me that in
                      order to have the copro working ok I need to save it's
                      environment so that the data of the victim process in
                      not altered. thanx!! Also fixed the cpuid read.

        14 May 2000 - Released first beta version to be tested

        ====================================================================
        Virus Name ........... Win32.Rammstein
        Virus Version ........ 4.0
        Virus Size ........... 13346 (debug), 14520 (release)
        Virus Author ......... Lord Julus / 29A
        Release Date ......... 04 May 2000
        Virus type ........... PE infector
        Target OS ............ Win95, Win98, WinNT, Win2000
        Target Files ......... many PE file types:
                               EXE COM ACM CPL HDI OCX PCI
                               QTC SCR X32 CNV FMT OCM OLB WPC
        Append Method ........ The  virus will check wether there is enough room
                               for  it  inside the code section. If there is not
                               enough  room  the virus will be placed at end. If
                               there  is  it  will  be  inserted inside the code
                               section  at  a  random  offset while the original
                               code will be saved at end. The placing at the end
                               has  also  two  variants.  If the last section is
                               Resources  or Relocations the virus will insert a
                               new section before the last section and place the
                               data  there,  also rearranging the last section's
                               RVAs.  If  the  last section is another section a
                               new  section  will  be placed at end. The name of
                               the new section is a common section name which is
                               choosed  based  on  the existing names so that it
                               does  not  repeat.  If the virus is placed at the
                               end just a small EPO code is used so that the eip
                               stays inside the code section.
                               A  special situation occurs if there is no enough
                               space  to  add  a new section header, for example
                               when  the  code section starts at RVA 200 (end of
                               headers).   In  this  situation  the  virus  will
                               increase the last section in order to append.
        Infect Methods ....... -Direct  file  attacks:  the  virus  will  attack
                               specific  files  in  the windows directory, files
                               which are most used by people
                               -Directory   scan:   all  files  in  the  current
                               directory will be infected, as well as 3 files in
                               the   system  directory  and  3  in  the  windows
                               directory
                               -Api  hooking  (per-process residency): the virus
                               hooks  a  few  api calls and infects files as the
                               victim  uses  the  apis
                               -Intranet  spreading:  the virus spreads into the
                               LAN using only windows apis
        Features ............. Multiple  threads:  the  virus  launches  a  main
                               thread.  While  this thread executes, in the same
                               time,  the original thread returns to host, so no
                               slowing  down  appears.  The  main  viral  thread
                               launches  other  6  threads  and  monitors  their
                               execution.  If  one of the threads is not able to
                               finish  the  system  is  hanged  because it means
                               somebody tryied to patch some of the thread code.
                               Heavy  anti-debugging:  i tried to use almost all
                               the  anti-debug  and  anti-emulation stuff that I
                               know
                               FPU: uses fpu instructions
                               Crc32 search: uses crc32 to avoid waste of space
                               Memory  roaming:  allocates  virtual  memory  and
                               jumps in it
                               Interlaced  code:  this  means  that some threads
                               share  the  same  piece  of code and the virus is
                               careful   to  let  only  one  in  the  same  time
                               otherwise we get some of the variables distroyed.
                               Preety hard to be emulated by avs.
                               Also features semaphores, timers
                               Marks infection using the Pythagoreic numbers.
                               SEH: the virus creates 9 SEH handlers, for each
                               thread and for the main thread.
   (*)  Polymorphic .......... Yes (2 engines: LJMLPE32, LJFPE32)
   (*)  Metamorphic .......... Yes (mild custom metamorphic engine)
        Encrypted ............ Yes
        Safety ............... Yes (avoids infecting many files)
        Kill AV Processes .... Yes
        Payload .............. On  14th  every  even  month the infected process
                               will  launch  a  thread  that will display random
                               windows  with  some  of  the  Rammstein's lyrics.
                               Pretty  annoying...  Probably  this  is the first
                               virus  that  actually  creates  real  windows and
                               processes  their  messages. The windows shut down
                               as the victim process closes.


        (*) Feature not included in this version.

        Debug notes: please note that this source code features many ways of
        debugging. You may turn on and off most of the virus's features by
        turning some variables to TRUE or FALSE.
        ====================================================================

           $
