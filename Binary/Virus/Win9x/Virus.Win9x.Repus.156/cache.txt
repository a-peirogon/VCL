   case A: There was no pending cache writes.

     case A-1: Before infection...


              VRP                       CacheBlock
              ÉÍÍÍÍÍÍÍÍÍÍ»<ÄÄÄ¿         ÉÍÍÍÍÍÍÍÍ»
              º          º    ³         º        º
              º          º    ³         º        º
              ºÄÄÄÄÄÄÄÄÄÄº    ÀÄÄÄÄÄÄÄÄÄÄ BLK+0C º=VRP
          1F4=º VRP+x-04 º              º BLK+10 ÄÄÄÄÄÄÄÄ> Buffer
              ºÄÄÄÄÄÄÄÄÄÄº              º        º
    NULL=List=º VRP+x+00 º              º BLK+1C º=?
              ºÄÄÄÄÄÄÄÄÄÄº              º BLK+20 º=?
              º          º              º        º
              º          º              º        º
              ºÄÄÄÄÄÄÄÄÄÄº              º BLK+32 º=00
        drive=º VRP+x+30 º              º        º
              ºÄÄÄÄÄÄÄÄÄÄº              ÈÍÍÍÍÍÍÍÍ¼
              º          º
              º          º
              º          º
              ÈÍÍÍÍÍÍÍÍÍÍ¼



     case A-2: After infection...


          VRP                               CacheBlock
          ÉÍÍÍÍÍÍÍÍÍÍ»<ÄÄÄ¿   ÚÄ>ÄÂÄ>ÄÂÄÄÄÄ>ÉÍÍÍÍÍÍÍÍ»
          º          º    ³   ³   ³   ³     º        º
          º          º    ³   ³   ³   ³     º        º
          ºÄÄÄÄÄÄÄÄÄÄº    ÀÄÄÄ³ÄÄÄ³ÄÄÄ³ÄÄÄÄÄÄ BLK+0C º=VRP
      1F4=º VRP+x-04 º        ³   ³   ³     º BLK+10 ÄÄÄÄÄÄÄÄ> Infected Buffer
          ºÄÄÄÄÄÄÄÄÄÄº        ³   ^   ^     º        º
     List=º VRP+x+00 ÄÄÄÄÄÄÄÄÄÙ   ³   ÀÄÄÄÄÄÄ BLK+1C º=List->Next
          ºÄÄÄÄÄÄÄÄÄÄº            ÀÄÄÄÄÄÄÄÄÄÄ BLK+20 º=List->Previous
          º          º                      º        º
          º          º                      º        º
          ºÄÄÄÄÄÄÄÄÄÄº                      º BLK+32 º=FF
    drive=º VRP+x+30 º                      º        º
          ºÄÄÄÄÄÄÄÄÄÄº                      ÈÍÍÍÍÍÍÍÍ¼
          º          º
          º          º
          º          º
          ÈÍÍÍÍÍÍÍÍÍÍ¼









   case B: There was some pending cache writes.

     case B-1: Before infection...


          VRP                CacheBlock
          ÉÍÍÍÍÍÍÍÍÍÍ»<ÄÄ¿   ÉÍÍÍÍÍÍÍÍ»
          º          º   ÀÄÄÄÄ BLK+0C º=VRP
          º          º       º BLK+10 ÄÄÄÄÄÄÄÄ> Buffer
          ºÄÄÄÄÄÄÄÄÄÄº       º BLK+1C º=?
      1F4=º VRP+x-04 º       º BLK+20 º=?
          ºÄÄÄÄÄÄÄÄÄÄº       º BLK+32 º=00
     List=º VRP+x+00 ÄÄÄ¿    ÈÍÍÍÍÍÍÍÍ¼
          ºÄÄÄÄÄÄÄÄÄÄº  ³
          º          º  v
          º          º  ³      BLK0        BLK1           BLKn
          ºÄÄÄÄÄÄÄÄÄÄº  ÀÄÂÄÄÄ>ÉÍÍ»<Ä¿ ÚÄÄ>ÉÍÍ»<Ä¿      Ä>ÉÍÍ»<Ä¿
    drive=º VRP+x+30 º    ³    º  ÄÄÄÄÄÙ   º  ÄÄÄÄÄ> ...  º  ÄÄÄ³ÄÄ¿
          ºÄÄÄÄÄÄÄÄÄÄº    ^  ÚÄÄ  º  ÀÄÄÄÄÄÄ  º  ÀÄÄ    <ÄÄ  º  ³  ³
          º          º    ³  v ÈÍÍ¼        ÈÍÍ¼           ÈÍÍ¼  ³  v
          º          º    ³  ³                                  ³  ³
          º          º    ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ<ÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³ÄÄÙ
          ÈÍÍÍÍÍÍÍÍÍÍ¼       ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ>ÄÄÄÄÄÄÄÄÄÄÄÙ



      case B-2: After infection...


          VRP                           CacheBlock
          ÉÍÍÍÍÍÍÍÍÍÍ»<ÄÄ¿    ÚÄÄÄÄÄÄÄÄ>ÉÍÍÍÍÍÍÍÍ»
          º          º   ÀÄÄÄÄ³ÄÄÄÄÄÄÄÄÄÄ BLK+0C º=VRP
          º          º        ³         º BLK+10 ÄÄÄÄÄÄÄÄ> Infected Buffer
          ºÄÄÄÄÄÄÄÄÄÄº        ³  ÚÄNextÄÄ BLK+1C º
      1F4=º VRP+x-04 º        ^  ³      º BLK+20 ÄÄPreviousÄÄÄÄ>ÄÄÄÄ¿
          ºÄÄÄÄÄÄÄÄÄÄº        ³  ³      º BLK+32 º=FF               ³
     List=º VRP+x+00 ÄÄÄÄ>ÄÄÄÄ´  ³      ÈÍÍÍÍÍÍÍÍ¼                  ³
          ºÄÄÄÄÄÄÄÄÄÄº        ³  v                                  ³
          º          º        ³  ³                                  v
          º          º        ³  ³                                  ³
          ºÄÄÄÄÄÄÄÄÄÄº        ^  ³  BLK0       BLK1           BLKn  ³
    drive=º VRP+x+30 º        ³  ÀÄ>ÉÍÍ»<Ä¿ ÚÄ>ÉÍÍ»<Ä¿      Ä>ÉÍÍ»<ÄÙ
          ºÄÄÄÄÄÄÄÄÄÄº        ³     º  ÄÄÄÄÄÙ  º  ÄÄÄÄÄ> ...  º  ÄÄÄÄÄÄ¿
          º          º        ÃÄÄ<ÄÄÄ  º  ÀÄÄÄÄÄ  º  ÀÄÄ    <ÄÄ  º     ³
          º          º        ³     ÈÍÍ¼       ÈÍÍ¼           ÈÍÍ¼     v
          º          º        ³                                        ³
          ÈÍÍÍÍÍÍÍÍÍÍ¼        ÀÄÄÄÄÄÄ<ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ


