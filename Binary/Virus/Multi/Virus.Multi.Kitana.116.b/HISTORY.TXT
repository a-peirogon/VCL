──────────────────────────────────────────────────────────────────────────────
    Вирусы семейства Kitana.                 Последняя версия: Kitana.116
    Первые версии созданы by FRiZER.         Дата его выпуска: 12.07.1999
    Последние - оптимизация by 2b и FRiZER.  Автор  изменений: FRiZER
──────────────────────────────────────────────────────────────────────────────

────[ Kitana.110 ]─(17.02.98)───────────────────────────────────[ FRiZER ]────
    Первая версия вируса. При запуске инфицированного файла вирус заражает
    MBR, переписывая его в 0/0/2. При вызове install.check, если вирус уже
    в памяти, то программа завершается. Причем резидентом вирус становится
    при старте из MBR, записываясь в последний 1kb доступной памяти. Вирус
    стелсируется при обращении к MBR, перехватывая обращение к 0/0/1 и пе-
    ренаправляя его в 0/0/2, но файлы он не заражает, т.е. вирус можно на-
    звать троянцем ;-)

────[ Kitana.138 ]─(25.02.98)───────────────────────────────────[ FRiZER ]────
    Теперь вирус занимается не только стелсированием, но и заражением com-
    и exe- файлов. Для этого он ожидает запись сектора, который начинается
    с 'щ' (jmp near) или 'MZ' и копирует свое тело в записываемый буфер.

────[ Kitana.113 ]─(27.02.98)───────────────────────────────────[ FRiZER ]────
    При  вызове install.check, вирусный обработчик возвращает управление в
    PSP:0 (там лежит int20h) и программа завершается. Убрано заражение exe
    и проведена оптимизация.

────[ Kitana.106 ]─(03.03.98)───────────────────────────────────[ FRiZER ]────
    Оптимизация Kitana.113

────[ Kitana.108 ]─(03.03.98)───────────────────────────────────[ FRiZER ]────
    Small bugfix Kitana.106

────[ Kitana.108 ]─(03.03.98)───────────────────────────────────[ FRiZER ]────
    Small bugfix Kitana.108

────[ Kitana.99 ]─(09.03.98)────────────────────────────────────[ FRiZER ]────
    Процедура получения управления real MBR изменена - теперь вирус, нахо-
    дясь  в  выделенном  для себя сегмента кладет в стек адрес возврата на
    адрес 0:7C00h и делает JMP FAR seg13:ofs13, т.е. после прочтения MBR в
    его  законное  место int13 вернет управление именно на его начало. EXE
    файлы перестали заражаться, т.к. определение их заголовка по букве 'M'
    дает ложные срабатывания. Опубликован в e-zine MooN_BuG #5.

────[ Kitana.101 ]─(12.03.98)───────────────────────────────────[ FRiZER ]────
    Этот вирус уже не мультипартитный, т.к. заражает только BOOT и MBR. Он
    записывается  в сектора, которые начинаются на JMP short (BOOT). Вирус
    состоит  из двух частей: первой частью является JMP short virus_start,
    вторая  это тело вируса. При записи сектора с JMP short в начале вирус
    записывает  сначала  переход  на  себя, а потом, пропуская часть байт,
    записывает  вирус.  Это  сделано  для того, чтобы не затронуть таблицу
    параметров дискеты. MBR он заражает также, не затрагивая партишен, при
    запуске из BOOT'а дискеты. Опубликован в e-zine MooN_BuG #5.

────[ Kitana.114 ]─(24.04.98)───────────────────────────────────[ FRiZER ]────
    Small bugfix Kitana.108

────[ Kitana.150 ]─(30.05.98)───────────────────────────────────[ FRiZER ]────
    Потомок  Kitana.114  - теперь шифрующийся со случайным значением ключа
    (рас)шифровки. Был сделан как вирус для конкурса на наиболее функцион-
    альный вирус размером в 150 байт, но так и не был послан. Вместо этого
    он был опубликован в e-zine MooN_BuG #6.

────[ Kitana.150 ]─(11.06.98)───────────────────────────────────[ FRiZER ]────
    Small bugfix Kitana.150

────[ Kitana.150 ]─(12.06.98)───────────────────────────────────[ FRiZER ]────
    Был отослан LovinGOD'у, который перевел  и  закинул его в e-zine TI#1,
    о чем я узнал только после прочтения этого журнала спустя почти год!!!
    Опубликован в e-zine MooN_BuG #7.

────[ Kitana.142 ]─(20.01.99)───────────────────────────────────[ FRiZER ]────
    Во  всех версиях Kitana.150 был обнаружен страшнейший баг - при записи
    в MBR он не шифровался, а при запуске оттуда пытался расшифровать себя
    на  самом  деле  шифруя тело, которое должно было получить управление.
    Поэтому шифровки в MBR больше нет - хватит и стелсирования. По сравне-
    нию с версиями Kitana.150 немного оптимизирован. Заражает EXE и MBR.

────[ Kitana.135 ]─(28.03.99)───────────────────────────────────────[ 2b ]────
    Оптимизация Kitana.142
    Hесколько интересных триков.

────[ Kitana.134 ]─(12.04.99)───────────────────────────────────[ FRiZER ]────
    Оптимизация Kitana.135 + small bugfix.

────[ Kitana.131 ]─(13.04.99)───────────────────────────────────[ FRiZER ]────
    Оптимизация Kitana.134

────[ Kitana.130 ]─(22.04.99)───────────────────────────────────────[ 2b ]────
    Оптимизация Kitana.131 + small bugfix.

────[ Kitana.132 ]─(29.05.99)───────────────────────────────────[ FRiZER ]────
    Small bugfix Kitana.131

────[ Kitana.127 ]─(18.06.99)───────────────────────────────────[ FRiZER ]────
    Изменен  алгоритм. Install.check больше нет. Вместо этого если вирус в
    памяти и дал нам прочитать real MBR, то при записи он проверяет запись
    сектора.  Если он начинается с 85h (как вирус), то вирус в памяти раз-
    решает писать эти сектора куда указано. За счет этого вирус уменьшился
    до 127 байт. Учтены fix'ы 2b в Kitana.131 (см. Kitana.130)

────[ Kitana.122 ]─(18.06.99)───────────────────────────────────[ FRiZER ]────
    Оптимизация  Kitana.127. Сначала получилось из-за перестановки всего 1
    команды  в другое место. Потом из-за того, что в предыдущей версии был
    изменен алгоритм.

────[ Kitana.121 ]─(19.06.99)───────────────────────────────────[ FRiZER ]────
    Оптимизация Kitana.122 - Заменен проверяемый при заражении MBR байт на
    0 (add al,al). Команда проверки сократилась на 1 байт.

────[ Kitana.121 ]─(19.06.99)───────────────────────────────────[ FRiZER ]────
    Сделал Kitana.121 более корректным - заражает только при записи секто-
    ра с 0E9h (jmp near) в начале. Раньше он записывался в буфер не только
    при записи, но и при чтении, что убивало все попытки запустить любой
    exe-файл. Теперь exe-файлы не заражаются.

────[ Kitana.121 ]─(19.06.99)───────────────────────────────────[ FRiZER ]────
    Сделана более корректная проверка места старта - MBR/COM.

────[ Kitana.120 ]─(21.06.99)───────────────────────────────────────[ 2b ]────
    Оптимизация Kitana.121
    Побочный эффект - AVP проснулся и заорал: "suspicion Type_Trojan"

────[ Kitana.116 ]─(24.06.99)───────────────────────────────────[ FRiZER ]────
    Оптимизация Kitana.120 - убрана проверка на зараженность MBR, т.к. все
    равно вирус не даст прочитать real MBR. AVP уже не кричит ;)

────[ Kitana.119 ]─(27.06.99)───────────────────────────────────[ FRiZER ]────
    Сделанное исправление в Kitana.120 оказалось ошибочным, т.к. юзер про-
    сто убивал MBR при втором запуски жертвы. AVP опять проснулся.

────[ Kitana.119a]─(24.06.99)───────────────────────────────────────[ 2b ]────
    Оптимизация Kitana.120

────[ Kitana.119b]─(24.06.99)───────────────────────────────────────[ 2b ]────
    Всякие извраты.

────[ Kitana.118a]─(25.06.99)───────────────────────────────────────[ 2b ]────
    Оптимизация Kitana.119

────[ Kitana.118b]─(25.06.99)───────────────────────────────────────[ 2b ]────
    Hе заражаем файлы на диске C

────[ Kitana.116b]─(30.06.99)───────────────────────────────────[ FRiZER ]────
    Оптимизация Kitana.118b. AVP заткнулся ;)

────[ Kitana.116c]─(12.07.99)───────────────────────────────────[ FRiZER ]────
    Small bugfix Kitana.116b. Если обращение шло не к HDD0 0/?/? и это бы-
    ла операция,  отличная от записи сектора с jmp near в начале, то номер
    сектора увеличивался на 1.

────[ Kitana.??? ]─(??.??.??)───────────────────────────────────[ ?????? ]────

    to be continued...


    p/S: если вы сможете сделать этот вирус более оптимальным по размеру,
         исправить какие-то ошибки или сделать интересные добавления,
         пишите на мой адрес: v666x@mail.ru или 2:5040/57.27


    Rest in Peace. FRiZER                                         12.07.99
──────────────────────────────────────────────────────────────────────────────
