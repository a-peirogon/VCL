Описание от Е.Касперского

 Frizer.987
 ──────────
Безобидный нерезидентный вирус. Ищет .COM-файлы, переносит начало файла в
его конец и записывает блоки своего кода в начало и конец заражаемого
файла. Содержит строку:

 [ Spreader beta2 by FRiZER ]

Вирус имеет необычную структуру кода и данных и использует достаточно
оригинальный алгоритм заражения файлов. Во-первых, код вируса разделен на
два блока. Первый блок (который записывается вирусом в начало файла)
содержит перехватчики отладочных прерываний INT 1,3 и таблицу инструкций
(см. ниже). Второй блок кода вируса (который размещается в конце файла)
содержит ассемблерные инструкции, выполняемые вирусом при поиске и
заражении файлов, т.е. второй блок является процедурой размножения вируса.

Основной особенностью вируса является тот факт, что ассемблерные команды во
втором блоке расположены в довольно необычном порядке. Вместо стандартного
набора команд (найти файл, открыть его, прочитать содержимое и т.д.) вирус
выполняет на первый взгляд совершенно неестественные действия: в регистры
загружаются корректные номера DOS-функций, но необходимые для их выполнения
DOS-вызовы INT 21h отсутствуют в коде вируса!

Hапример, вирус использует DOS-вызов INT 21h при выделении блока памяти для
буфера чтения/записи (здесь все выглядит корректно), однако затем коды
вызова INT 21h отсутствуют:

 MOV AH,48h     ; выделить блок памяти
 INT 21h        ; DOS-вызов
 ...
 MOV AH,1Ah     ; установить DTA
 MOV DX,DI      ; DOS-вызов отсутствует
 MOV AH,4Eh     ; найти файл
 MOV CX,0020h
 JNC ...        ; DOS-вызов отсутствует

Последующий анализ алгоритма вируса показывает, что вирус на самом деле
вызывает INT 21h, однако при этом используется код INT 21h из первой
команды. Для того, чтобы совершать такие несуразные действия вирус
использует таблицу инструкций из первого блока вируса. Эта таблица содержит
список указателей на инструкции, которые должны выполняться при поиске и
заражении файлов. Для корректного выполнения кода, приведенного выше, вирус
использует примерно такую таблицу:

 указатель на  MOV AH,48h
 указатель на  INT 21h
 ...
 указатель на  MOV AH,1Ah
 указатель на  MOV DX,DI
 указатель на  INT 21h     ; указывает на тот же INT 21h, что и выше
 указатель на  MOV AH,4Eh
 указатель на  MOV CX,0020h
 указатель на  INT 21h     ; указывает на тот же INT 21h, что и выше
 указатель на  JNC ...

Для того, чтобы процессор выполнял только одну инструкцию (или необходимое
количество инструкций), вирус использует INT 1/3: устанавливает режим
трассировки, выполняет команду по первому указателю, проверяет необходимые
условия, затем выполняет команду по следующему указателю и т.п.

В результате такого необычного подхода к исполнению процедур вирус содержит
только одну копию каждой выполняемой инструкции (за очень редкими
исключениями). Если вирусу необходимо выполнить инструкцию, которая уже
присутствует в его коде, он всего-лишь обращается по тому же указателю.

Более того, при заражении файлов вирус сканирует их содержимое на наличие
инструкций из своего второго блока. Если такие инструкции обнаружены, вирус
устанавливает указатели в своей таблице на тело заражаемого файла - то есть
вирус использует и выполняет команды заражаемого файла. Естественно, что в
этом случае вирус не записывает обнаруженные инструкции в свой второй блок,
и размер заражаемых файлов увеличивается на значение меньшее длины вируса.

В результате такого метода заражения вирус использует код зараженной
программы, т.е. вирус не просто заражает файлы, но и "интегрирует" свой код
с кодом зараженных программ.

